---
title: Linux命令 adb
date: 2016-10-08T16:46:14+08:00
update: 2017-03-27 16:50:34
categories: [linux_base]
tags: [adb]
---
sudo apt-get install android-tools-adb
sudo apt-get install android-tools-fastboot
# 启动fastboot模式
adb reboot bootloader  


## 查看手机上应用
adb shell pm list packages
pm list packages -f 显示安装位置

配置USB访问权限`/etc/udev/rules.d/51-android.rules`
wget -S -O - http://source.android.com/source/51-android.rules | sed "s/<username>/$USER/" | sudo tee >/dev/null /etc/udev/rules.d/51-android.rules;
sudo udevadm control --reload-rules
[一份超全超详细的 ADB 用法大全 - MengGang - CSDN博客](http://blog.csdn.net/u010375364/article/details/52344120)


bmgr是一个shell工具你可以用来与备份管理器在Android设备（支持API级别8或更高）。它提供了命令来指导的备份和恢复操作,这样你不需要反复清除数据或采取类似的侵入性的步骤来测试您的应用程序的备份代理。这些命令是通过adb shell。

使用备份操作
通常，应用程序必须通知备份管理器在它的数据已经改变。通过dataChanged()。备份管理器将调用您的备份代理的onBackup()实现在未来某个时刻。如果调用dataChanged()，可以调用一个备份请求从命令行运行bmgr备份命令。

命令：
adb shell bmgr backup <package>

当您执行该备份命令,您的应用程序的备份代理将调用来执行备份操作在未来一段时间内(通过你的onBackup()方法),尽管没有保证当它会发生。然而,您可以强制执行所有没有运行的备份操作，通过使用bmgr运行命令:

命令：
Adb shell bmgr run

这个命令会导致所有调用备份代理的应用程序的都备份。

使用恢复操作
恢复操作不像备份操作，这是成批的在一起运行在一个偶然的基础上，立即执行恢复操作。备份管理器目前提供了两种类型的恢复操作。
第一种恢复整个装置的数据备份。典型的表现只有当一个设备是第一个提供(复制设置和其他保存的状态从用户之前的设备)，是一个操作，只有系统可以执行。
第二种恢复操作单个应用程序恢复到它的“活跃的”数据集；也就是说，应用程序将放弃其当前数据和恢复到最后一次正确数据，保存在当前的备份映像。
您可以调用第二个恢复操作与requestRestore()方法。备份管理器将调用您的备份代理的onRestore()实现。

当测试您的应用程序，你可以立即调用恢复操作，绕过requestRestore（）方法。使用bmgr恢复命令：
adb shell bmgr restore <package>
备份管理器将立即实例化应用程序的备份代理和调用它来恢复。这将发生，即使应用程序是当前没有运行。

其他命令：
Wiping data（擦拭数据）

一个应用程序的数据可以被清除从Activity数据集合中。这个操作非常有用，当你在开发一个备份代理。以防错误引导你写错误的数据或保存的状态信息。你可以擦拭一个应用程序的数据与bmgr擦拭命令：
adb  shell  bmgr  wipe <package>

接下来的备份操作应用程序的代理进程将看起来好像应用程序从未支持任何东西之前。

查看backup（备份）是否可用
adb shell bmgr enabled

如果备份操作可用的，如果您的应用程序的备份代理是从未被调用备份，以验证操作系统是否认为它应该执行这些操作。

你也可以直接禁用或启用备份管理器：
adb shell bmgr enable <boolean>

警告!
当备份是禁用的，当前的备份运输将明确地擦拭Activity中的数据。如果当一个用户说他们不希望他们的数据备份，备份管理器方面希望。则没有新的数据将被保存从设备，没有恢复操作将成为完成恢复操作。除非备份管理器是重新启用(通过设置或通过以上bmgr命令)。



# adb
- 启动adb服务,如果它没启动的话
  adb start-server
- 关闭服务
  adb kill-server
- 查看所连接的设备以及设备所对应的序列号
  adb devices
- 安装app,需要注意的是如果连接了两台设备,则会报错,此时可以添加-s <serialNumber>来处理
  adb install -r xxxx.apk
- 卸载app
  adb uninstall packagename

- 连接到指定的ip,这个通常配合wifidebug
  adb connect <device-ip-address>
- 从手 机复制文件出来
  adb pull <remote> <local>
- 向手机发送文件
  adb push <local> <remote>
  adb push foo.txt /sdcard/foo.txt
- 查看bug报告
  adb bugreport
- 获取设备的ID和序列号
  adb get-product
  adb get-serialno

- 进入shell环境
  adb shell
- 打印出内核的调试信息
  adb shell dmesg
- 清除应用的数据,很常用吧?
  adb shell pm clear packagename
- 查看栈顶Activity,可以用来获取包名
  adb shell dumpsys activity top
- 查看所有已安装的应用的包名
  adb shell pm list packages -f
- am的状态 Activity Manager State
  adb shell dumpsys activity
- 包信息 Package Information
  adb shell dumpsys package
- 内存使用情况Memory Usage
  adb shell dumpsys meminfo
- Memory Use Over Time
  adb shell dumpsys procstats
- Graphics State
  adb shell dumpsys gfxinfo

  adb shell cat /proc/cpuinfo

  6、删除Android系统Rom自带的软件

    a.确定手机root了,取得了root权限才能删除系统文件呀.
    b.下载Android_db.rar,解压到%windir/%System32下.
    c.手机连接数据线,在电脑上打开cmd,然后输入命令
            adb remount
            adb shell
            su
            执行完成之后,你会看到:
            * daemon not running. starting it now *
            * daemon started successfully *
    d.接着就是基础 命令行模式了,输入
            cd system/app
            你会发现没啥变化,然后输入ls回车.
            这时候列表显示了system/app里面的所有文件,也就是Rom集成的一些软件了.
    e.开始删除吧！比如删除Youtube,他的文件名是Youtube.odex和Youtube.apk
            我们要删除这2个文件,敲入以下命令:
            rm Youtube.*
            重启,Youtube已经删除掉了,注意各位同学千万不要删除你不知道是啥的东西.
