---
title: Linux命令 PHP
date: 2016-02-26T15:30:01+08:00
update: 2016-01-01
categories: [Linux基础]
tags: [PHP]
---
[CentOS 7 用户怎样安装 LNMP](http://www.linuxidc.com/Linux/2014-09/106192.htm)
[CentOS 7.0安装配置LAMP服务器(Apache+PHP+MariaDB)](http://www.osyunwei.com/archives/7882.html)
[CentOS 7 下安装 LEMP 服务(nginx、MariaDB/MySQL 和 php)](http://www.tuicool.com/articles/EJ3uY3)

sudo apt install nginx-full
sudo apt install php

nginx和fastcgi的通信方式有两种，一种是TCP的方式，一种是unix socket方式
TCP和unix domain socket方式对比
TCP是使用TCP端口连接127.0.0.1:9000
Socket是使用unix domain socket连接套接字/dev/shm/php-fpm.sock
/dev/shm是个tmpfs，速度比磁盘快得多
################################################################################
## 采用unix socket方式
![](http://www.phpddt.com/usr/uploads/2015/08/2082710571.png)

1. 修改php-fpm.conf配置
  sudo vim /etc/php/7.0/fpm/pool.d/www.conf
```
    #listen = 127.0.0.1:9000
    listen=/dev/shm/php7.0-fpm.sock       #/dev/shm/为内存文件系统，注意 确保可读写    
    listen.owner=nginx                #注意自己的用户和组
    listen.group=nginx
```

2. 修改nginx.conf配置
```
    user nginx;

    http {

      server {
    	    listen       80;
    	    server_name  localhost;

    	    location ~ .php$ {
    	        root /home/ubuntu/ky_server_weixin;
    	        try_files $uri =404;

    	      	#fastcgi_pass   127.0.0.1:9000;
    	        fastcgi_pass   unix:/dev/shm/php7.0-fpm.sock;

              fastcgi_index  index.php;
    	        fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
    	        include        fastcgi_params;
    	    }

    	}
    }
```

3. 重启nginx和php-fpm

  nginx -s reload
  service nginx restart
  /etc/init.d/nginx start

  /etc/init.d/php7.0-fpm restart

4. 添加测试文件 info.php

  ```
  <?php
    phpinfo();
  ?>
  ```

################################################################################
