---
title: Beats开发指南
date: 2016-10-04T04:15:26+08:00
update: 2016-10-04 04:15:26
categories:
tags:
---
1. 创建beat项目
`python $GOPATH/src/github.com/elastic/beats/script/generate.py`

2. 安装环境依赖
cd ${GOPATH}/src/github.com/{user}/mybeat
`make setup`

3. 编译 运行
`make`
`./countbeat -e -d "*"`


4. 导入 dashboards

   `./scripts/import_dashboards -dir kibana/metricbeat`
    `./scripts/import_dashboards -file metricbeat-dashboards-1.1.zip`
    `./scripts/import_dashboards -url https://artifacts.elastic.co/downloads/beats/beats-dashboards/beats-dashboards-5.4.1.zip`
    ./scripts/import_dashboards -es http://120.92.36.21:9200 -user elastic -pass changeme
          `beats/libbeat/dashboards/import_dashboards -beat metricbeat`
  index_pattern   `./scripts/import_dashboards -only-index`
  dashboards  `./scripts/import_dashboards -only-dashboards`

docker run --rm -it docker.elastic.co/beats/heartbeat:5.4.0 /usr/share/heartbeat/scripts/import_dashboards -beat "heartbeat"  -file /usr/share/heartbeat/beats-dashboards-5.4.0.zip  -es http://139.129.234.31:9200  -user elastic   -pass changeme

5. 根据 `_meta/fields.yml` 生成`index_pattern`
  `make update`

   根据 fields.yaml 导入elastic template
   ```yaml
   output.elasticsearch:
      hosts: ["localhost:9200"]
      template.name: "metricbeat"
      template.fields: "fields.yml"
      template.overwrite: false
   ```
6. 导出
ES_URL="http://192.168.3.206:9200" make export-dashboards

7. 打包 dashboards
`make package-dashboards`
