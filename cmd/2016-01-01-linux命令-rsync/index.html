<!DOCTYPE html>
<html lang="zh-CN" class="no-js">
<head>
  <meta charset="UTF-8">
  <base href="//blog.pytool.com/">
  <script>
    document._writeOriginal = document.write;
    document.write = function(str) {
        if (str.indexOf('livereload.js') > -1) {
            document._writeOriginal(str);
        } else {
            document._writeOriginal('<!-- Be Hijack!! -->');
        }
    }
  </script>
<title>Linux命令 rsync - 时光小栈</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

<meta name="description" content="rsync 主要定义符及含义 # %h远程主机名 # %a远程IP地址 # %l文件长度字符数 # %p该次rsync会话的进程id # %o操作类型：&rdquo;se">
<meta name="author" content=rinetd>
<meta name="publisher" content=rinetd@163.com>

<meta itemprop="name" content="Linux命令 rsync - 时光小栈">
<meta itemprop="description" content="rsync 主要定义符及含义 # %h远程主机名 # %a远程IP地址 # %l文件长度字符数 # %p该次rsync会话的进程id # %o操作类型：&rdquo;se">
<meta itemprop="image" content="//blog.pytool.com/public/avatar.png">

<meta property="og:type" content="article" />
<meta property="og:title" content="Linux命令 rsync - 时光小栈" />
<meta property="og:description" content="rsync 主要定义符及含义 # %h远程主机名 # %a远程IP地址 # %l文件长度字符数 # %p该次rsync会话的进程id # %o操作类型：&rdquo;se">
<meta property="og:image" content="//blog.pytool.com/public/avatar.png" />
<meta property="og:url" content="//blog.pytool.com/cmd/2016-01-01-linux%E5%91%BD%E4%BB%A4-rsync/" />

<meta name="baidu-site-verification" content="pCInWQYbNT" />
<meta name="google-site-verification" content="ifeWsnNpU7w8vP3ii_Cjq-P9LKw3ngVitnMWv4XmJqk" />


<script>document.documentElement.className = document.documentElement.className.replace("no-js", "js");</script>
<link rel="canonical" href="//blog.pytool.com/cmd/2016-01-01-linux%E5%91%BD%E4%BB%A4-rsync/">
<link rel='shortlink' href="//blog.pytool.com/cmd/2016-01-01-linux%E5%91%BD%E4%BB%A4-rsync/"/>
<link rel="shortcut icon" href="//blog.pytool.com/public/favicon.ico"/>

<link rel="stylesheet" id="human-style-css" href="//blog.pytool.com/wp-content/themes/hueman/style.css" type="text/css" media="all"/>
<link rel="stylesheet" id="human-style-css1" href="//blog.pytool.com/wp-content/themes/hueman/custom.css" type="text/css" media="all"/>
<link rel="stylesheet" id="human-style-css2" href="//blog.pytool.com/wp-content/themes/hueman-child/style.css" type="text/css" media="all"/>
<link rel="stylesheet" id="responsive-css" href="//blog.pytool.com/wp-content/themes/hueman/responsive.css" type="text/css" media="all"/>
<link rel="stylesheet" id="font-awesome-css" href="//blog.pytool.com/wp-content/themes/hueman/fonts/font-awesome.min.css" type="text/css" media="all"/>

<link rel="stylesheet" href="//blog.pytool.com/public/highlight/styles/github.css">
<link rel="stylesheet" id="human-style-css3" href="//blog.pytool.com/wp-content/themes/hueman-child/user.css" type="text/css" media="all"/>
<link rel="stylesheet" href="//blog.pytool.com/public/font/hack/css/hack.min.css">

</head>


<body class="single single-post single-format-standard col-3cm full-width topbar-enabled chrome">
<div id="wrapper">
  <header id="header">

  <nav class="nav-container group" id="nav-topbar">
    <div class="nav-toggle"><i class="fa fa-bars"></i></div>
    <div class="nav-text"></div>
    <div class="nav-wrap container">
      <a rel="nofollow" href="//blog.pytool.com/" class="nav-cs-icon">
        <img width="40" height="40" src="//blog.pytool.com/public/avatar.png" alt="rinetd" title="Home">
      </a>
      <ul id="menu-default-menu" class="nav container-inner group">
        <li class="menu-item menu-item-type-post_type menu-item-object-page">
          <a rel="nofollow" href="//blog.pytool.com/">Home</a>
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="//blog.pytool.com/basic/">Basic</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="//blog.pytool.com/cmd/">Cmd</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="//blog.pytool.com/edit/">Edit</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="//blog.pytool.com/hacker/">Hacker</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="//blog.pytool.com/hardware/">Hardware</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="//blog.pytool.com/hugo/">Hugo</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="//blog.pytool.com/linux/">Linux</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="//blog.pytool.com/life/">Life</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="//blog.pytool.com/other/">Other</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="//blog.pytool.com/post/">Post</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="//blog.pytool.com/reship/">Reship</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="//blog.pytool.com/tool/">Tool</a>
          
        </li>
        
        
        <li class="menu-item menu-item-type-post_type menu-item-object-page">
          <a rel="nofollow" href="//blog.pytool.com/post/">Post</a>
        </li>
        
        <li class="menu-item menu-item-type-post_type menu-item-object-page">
          <a rel="nofollow" href="//blog.pytool.com/about/">about</a>
        </li>
        

        
      </ul>

    </div>

    <div class="container">
      <div class="container-inner">
        <div class="toggle-search"><i class="fa fa-search"></i></div>
        <div class="search-expand">
          <div class="search-expand-inner">
            <form method="get" class="searchform themeform" action="https://www.google.com/search">
              <div>
                <input type="text" class="search" name="q" placeholder="Press enter to start searching">
              </div>
            </form>
          </div>
        </div>
      </div>
      
    </div>
    

  </nav>
  

  <div class="container group">
    <div class="container-inner">
      <div class="group pad">
        <div class="group pad">
          <h1 class="site-title">
            <a rel="nofollow" href="//blog.pytool.com/" rel="home">
              
              
            </a>
          </h1>
          <p class="site-description"> Don&#39;t put any lines in your CODE that you don&#39;t understand </p>
        </div>

      </div>
    </div>
    
  </div>
  

</header>



  <div class="container" id="page">
    <div class="container-inner">
      <div class="main">
        <div class="main-inner group">
          <section class="content">
            <div class="page-title pad group">
              <ul class="meta-single group">
                
                <li class="category">
                  <a href="//blog.pytool.com/categories/linux%E5%91%BD%E4%BB%A4/" rel="category tag">Linux命令</a>
                </li>
                
              </ul>
            </div>

            <div class="pad group">

              <article
                  class="post type-post status-publish format-standard has-post-thumbnail hentry category-australien tag-bondi-beach tag-city2surf tag-sydney">
                <div class="post-inner group">

                  <h1 class="post-title">Linux命令 rsync</h1>

                  <p class="post-byline">
                    by  · 2016年01月06日 16:46:14 · 11598 Words ·
                    ~24min reading time |
                    
                    <a href="https://coding.net/u/rinetd/p/blog/git/edit/master/content/cmd/2016-01-01%20Linux%e5%91%bd%e4%bb%a4%20rsync.md" target="_blank">Improve on <i class="fa fa-git-square"></i></a>
                  </p>

                  <div class="clear"></div>

                  <div class="entry">
                    <div class="entry-inner">
                      
                      

<p>rsync 主要定义符及含义
 # %h远程主机名
 # %a远程IP地址
 # %l文件长度字符数
 # %p该次rsync会话的进程id
 # %o操作类型：&rdquo;send&rdquo;或&rdquo;recv&rdquo;
 # %f文件名
 # %P模块路径
 # %m模块名
 # %t当前时间
 # %u认证的用户名(匿名时是null)
 # %b实际传输的字节数
 # %c当发送文件时，该字段记录该文件的校验码
 #默认log格式为：&rdquo;%o %h [%a] %m (%u) %f %l&rdquo;，一般来说,在每行的头上会添加&rdquo;%t [%p] &ldquo;。
 log format=%o %h [%a] %m (%u) %f %l</p>

<p><a href="http://blog.opskumu.com/rsync.html">rsync 备份备忘 — » Kumu&rsquo;s Blog</a>
ssh root@keyicloud.com
<code>rsync -avzH /var/www qubuluo.com:/keyi/</code>
rsync -avzH /var/www/www-data/yiming/ yimengapp.com:/var/www/yimeng/www-data/
rsync -avzH /var/www/mysql/yiming/ yimengapp.com:/var/www/yimeng/mysql/</p>

<p><code>rsync -e &quot;ssh -p 222&quot; -avzH . root@yimengapp.com:nginx</code>          复制本地文件夹到服务器
<code>rsync -e &quot;ssh -p 222&quot; -avzH git.yimengapp.com:docker/ ~/docker/</code> 复制服务器文件夹到本地</p>

<p>rsync &ldquo;-e ssh -p3009&rdquo; -avzH  /usr/local/tomcat8/webapps/websitems-hadoop/ root@114.215.45.96:/docker/tomcat/webapps/websitems/</p>

<h2 id="允许修改权限">允许修改权限</h2>

<p><code>--super --perms --chmod=0777</code></p>

<h2 id="允许修改所有者-默认修改为本地执行者身份">允许修改所有者 默认修改为本地执行者身份</h2>

<p><code>--owner --group --chown=www-data:www-data</code>
rsync &ndash;perms  &ndash;chmod=0777  &ndash;owner &ndash;group&ndash;chown=www-data:www-data -e &ldquo;ssh -p 3009&rdquo; &ndash;rsync-path=&ldquo;sudo rsync&rdquo; echo.sh root@d1:</p>

<p>rsync 自动创建目录  -R
ssh user@host mkdir -p <code>dirname $path</code> &amp;&amp; rsync &hellip;</p>

<h1 id="转移临沂政府评估-hadoop项目">转移临沂政府评估 hadoop项目</h1>

<p>rsync &ldquo;-e ssh -p3009&rdquo; -avzH &ndash;exclude 404html/ &ndash;exclude ueditor/ &ndash;exclude blanktable/ /usr/local/tomcat8/webapps/websitems-hadoop root@118.190.117.111:/docker/tomcat/webapps/websitems-hadoop/
 rsync &ldquo;-e ssh -p3009&rdquo; -avzH  /usr/local/tomcat8/webapps/websitems-hadoop/ root@114.215.45.111:/docker/tomcat/webapps/websitems/</p>

<pre><code>vi etc/lsyncd.conf
启动 lsyncd lsyncd.conf
# lsyncd -nodaemon lsyncd.conf

settings {
    -- logfile =&quot;/var/lsyncd.log&quot;,
    -- statusFile =&quot;/var/lsyncd.status&quot;,
    inotifyMode = &quot;CloseWrite&quot;,
    maxProcesses = 8,
    }

sync {
    default.rsyncssh,
    source    = &quot;/home/ubuntu/go/src/github.com/VirrageS/chirp/backend&quot;,
    host      = &quot;root@demo.linyibr.com&quot;,
    targetdir = &quot;docker/linyibr/bianban/master&quot;,
    exclude = { 'vendor/','*/' , '*file',&quot;*.go&quot;, 'lsyncd*', &quot;*config.yaml&quot; ,'api.1.yaml'},
    -- excludeFrom = &quot;/etc/rsyncd.d/rsync_exclude.lst&quot;,
    -- maxDelays = 5,
    delay = 0,
    -- init = false,
    delete 	= 	false,
    rsync    = {
        binary = &quot;/usr/bin/rsync&quot;,
        archive = true,
        compress = true,
        verbose   = true,
        _extra = {&quot;--bwlimit=2000&quot;},
        },
    ssh      = {
        port  =  222
        }
    }

</code></pre>

<h1 id="远程服务器创建目录-forcing-rsync-to-create-a-remote-path-using-rsync-path">远程服务器创建目录 Forcing Rsync to Create a Remote Path Using <code>–rsync-path</code></h1>

<p>If you have more than the last leaf directory to be created, you can either run a separate ssh &hellip; mkdir -p first, or use the &ndash;rsync-path trick as explained here :</p>

<p><code>rsync -a --rsync-path=&quot;mkdir -p /tmp/x/y/z/ &amp;&amp; rsync&quot; $source user@remote:/tmp/x/y/z/</code></p>

<p>Or use the &ndash;relative option as suggested by Tony. In that case, you only specify the root of the destination, which must exist, and not the directory structure of the source, which will be created:</p>

<p>rsync -a &ndash;relative /new/x/y/z/ user@remote:/pre_existing/dir/</p>

<p>This way, you will end up with /pre_existing/dir/new/x/y/z/</p>

<p>一.rsync简介
    rsync参数的具体解释如下：
    -h, &ndash;help            显示帮助信息
    -v, &ndash;verbose         显示同步过程详细信息
    -P，&ndash;partial          &ndash;progress 断点续传
    -e, &ndash;rsh=COMMAND     指定使用rsh、ssh方式进行数据同步
    -n, &ndash;dry-run         显示哪些文件将被传输，只测试输出而不正真执行命令，推荐使用，特别防止 &ndash;delete 误删除！
    -a, &ndash;archive         归档模式，表示以递归方式传输文件，并保留所有文件属性，等于-rlptgoD
        -r, &ndash;recursive       对子目录以递归模式处理
        -l, &ndash;links           保留软链结
        -p, &ndash;perms           保留文件权限
        -t, &ndash;times           保留文件时间信息
        -o, &ndash;owner           保留文件属主信息
        -g, &ndash;group           保留文件属组信息
        -D, &ndash;devices         保留设备文件信息<br />
    -H, &ndash;hard-links      保留硬链结
    -q, &ndash;quiet           精简输出模式
    -c, &ndash;checksum        打开校验开关，强制对文件传输进行校验<br />
    -R, &ndash;relative        使用相对路径信息
    -b, &ndash;backup          创建备份，也就是对于目标已经存在同名文件时，将原先的文件重新命名为~filename。可以使用&ndash;suffix选项来指定不同的备份文件前缀。
    -u, &ndash;update          仅仅进行更新，也就是跳过所有已经存在于DST，并且文件时间晚于要备份的文件。(不覆盖更新的文件)
    -L, &ndash;copy-links      像对待常规文件一样处理软链结
    -S, &ndash;sparse          handle sparse files efficiently  对稀疏文件进行特殊处理以节省 DST 的空间
    -W, &ndash;whole-file      强制重传,不管有没有改变，再次把所有文件都传输一遍
    -x, &ndash;one-file-system 不要跨越文件系统边界
    -B, &ndash;block-size=SIZE 检验算法使用的块尺寸，默认是700字节
    -C, &ndash;cvs-exclude     使用和CVS一样的方法自动忽略文件，用来排除那些不希望传输的文件
    -I, &ndash;ignore-times    不跳过那些有同样的时间和长度的文件
    -T &ndash;temp-dir=DIR     在DIR中创建临时文件
    -z,&ndash;compress         对备份的文件在传输时进行压缩处理</p>

<pre><code>--existing 只同步已经存在的文件，不创建新文件
--delete              删除那些DST中有而SRC没有的文件，即删除目标端中多余的文件；
--include=PATTERN     指定需要传输的文件模式     ` --include '*.conf' `
--exclude=PATTERN     指定不需要传输的文件模式   ` --exclude '*' `


--delete-excluded：专门指定一些要在目的端删除的文件。应该是说加了这个选项，不管有没有指定 excluded 也是会被删除。

--backup-dir          将备份文件(如~filename)存放在在目录下。
--suffix=SUFFIX       定义备份文件前缀
--copy-unsafe-links   仅仅拷贝指向SRC路径目录树以外的链结
--safe-links          忽略指向SRC路径目录树以外的链结
--rsync-path=PATH     指定远程服务器上的rsync命令所在路径信息
--existing            仅仅更新那些已经存在于DST的文件，而不备份那些新创建的文件
--delete-excluded     同样删除接收端那些被该选项指定排除的文件
--delete-after        传输结束以后再删除
--ignore-errors       及时出现IO错误也进行删除
--max-delete=NUM      最多删除NUM个文件
--partial             保留那些因故没有完全传输的文件，以是加快随后的再次传输
--force               强制删除目录，即使不为空
--numeric-ids         不将数字的用户和组ID匹配为用户名和组名
--timeout=TIME        IP超时时间，单位为秒
--size-only           当决定是否要备份文件时，仅仅察看文件大小而不考虑文件时间
--modify-window=NUM   决定文件是否时间相同时使用的时间戳窗口，默认为0
--compare-dest=DIR    同样比较DIR中的文件来决定是否需要备份
--progress            显示传输过程
--exclude-from=FILE   排除FILE中指定模式的文件
--include-from=FILE   不排除FILE指定模式匹配的文件
--version             打印版本信息
--address             绑定到特定的地址
--config=FILE         指定其他的配置文件，不使用默认的rsyncd.conf文件
--port=PORT           指定其他的rsync服务端口
--blocking-io         对远程shell使用阻塞IO
--stats               给出某些文件的传输状态
--progress            在传输时现实传输过程
--log-format=formAT   指定日志文件格式
--password-file=FILE  从FILE中得到密码
--bwlimit=KBPS        限制I/O带宽，KBytes per second
</code></pre>

<p>Rsync（remote synchronize）是一个远程数据同步工具，可通过LAN/WAN快速同步多台主机间的文件，也可以使用 Rsync 同步本地硬盘中的不同目录。 在使用 rsync 进行远程同步时，可以使用两种方式：远程 Shell 方式（建议使用 ssh，用户验证由 ssh 负责）和 C/S 方式（即客户连接远程 rsync 服务器，用户验证由 rsync 服务器负责）。rsync 被称为是一个文件同步的快速方法，主要是因为其在同步文件时会检查文件之间是否有差异，它只同步存在差异或者不存在的文件，但是首次同步时速度依然很慢。</p>

<p>rsync有许多选项：
    -n: 在不确定命令是否能按意愿执行时，务必要事先测试；-n可以完成此功能；
    -a: &ndash;archives，归档模式，表示以递归方式传输文件，并保持所有文件属性，等于 -rlptgoD
        -r: &ndash;recursive，递归复制；
        -l: &ndash;links 保留文件的符号链接
        -p: &ndash;perms 保留文件的权限
        -t: &ndash;times 保留文件的时间戳
        -g: &ndash;group 保留文件的属组
        -o: &ndash;owner 保留文件的属主
        -D： &ndash;devices 保留设备文件
    -v: &ndash;verbose，详细输出模式
    -z: &ndash;compress，对文件压缩后传输
    -e ssh: 表示使用ssh协议作承载
    -H, &ndash;hard-links 保留硬链结;
    -P: &ndash;partial &ndash;progress 断点续传
    -W:  强制重传,不管有没有改变，再次把所有文件都传输一遍
    -q: &ndash;quiet，静默模式
    -c: &ndash;checksum，开启校验功能，强制对文件传输进行校验</p>

<pre><code>-S, --sparse 对稀疏文件进行特殊处理以节省DST的 空间;
--progress：显示进度条
--stats: 显示如何执行压缩和传输 ，可以显示有多少文件需要同步，需要传输的具体容量
--existing 只同步已经存在的文件，不创建新文件
默认的情况下，当rsync传输中断后，新的rsync传输将删除所有的未完成的残余文件片段，然后开始新的传输。而使用--partial后，将会进行我们所说的断点续传。
值得注意的是-P这个参数是综合了--partial --progress两个参数，所以rsync的断点续传可以
</code></pre>

<p>带你走进rsync的世界带你走进rsync的世界</p>

<h1 id="使用-rsync-同步的时候-可否指定-ssh-的端口号">使用 rsync 同步的时候，可否指定 ssh 的端口号？</h1>

<p>在 ~/.ssh/config 里面指定该Host的端口</p>

<pre><code>Host remotehost
  Port 2345
</code></pre>

<p>rsync + ssh 使用不同 port 執行</p>

<p>rsync + ssh 使用不同 port 的話, 需要加上 -e &ldquo;ssh -p port_number&rdquo;, ex: 假設遠端的 ssh 機器是用 1234 port, 指令會如下述:</p>

<pre><code>rsync -e &quot;ssh -p 1234&quot; -avz --bwlimit=3000 REMOTE_HOST:data_path .
</code></pre>

<p>另一種使用 &ndash;rsh=&lsquo;ssh -pPORT_NUMBER&rsquo;, 如下述範例:</p>

<pre><code>rsync --rsh='ssh -p1234' -avz --bwlimit=3000 REMOTE_HOST:data_path .
</code></pre>

<p>另外一個是透過 .ssh/config, 做 ssh 遠端機器的相關設定, 如下述範例:</p>

<pre><code>vim .ssh/config
Host REMOTE_HOST # 這個可以寫簡寫, 但是下面 rsync 的REMOTE_HOST 需與此一致.
HostName REMOTE_HOST
User YOUR_USERNAME
Port 1234
IdentityFile /home/YOUR_USERNAME/.ssh/id_rsa # 如果有在寫, 沒有這行可跳過不寫
rsync -avz --bwlimit=3000 REMOTE_HOST:data_path . # 這邊就可以直接 rsync 即可.
</code></pre>

<p>rsync -av keyicloud.com:/var/www/www-data/yimeng  /home/feiyu/
二，rsync使用方法</p>

<p>rsync可以在此处下载   <a href="http://rsync.samba.org/">http://rsync.samba.org/</a>  ，CentOS系统上rsync默认是安装的。</p>

<p>rsync有 <strong>六种</strong> 不同的工作模式： 单个&rdquo;:&rdquo; ssh 模式； 两个&rdquo;::&rdquo; rsyncd 服务模式
1. 拷贝本地文件</p>

<p>当SRC和DES路径信息都不包含有单个冒号”:”分隔符时就启动这种工作模式。</p>

<p>[root@localhost ~]# <code>rsync -avSH /home/feiyu/ /bak/</code></p>

<p>2.将本地机器的内容拷贝到远程机器
使用一个远程shell程序（如rsh、ssh）来实现将本地机器的内容拷贝到远程机器。当DST路径地址包含单个冒号”:”分隔符时启动该模式。
[root@localhost ~]# <code>rsync -av /home/feiyu/ 192.168.0.24:/home/feiyu/</code></p>

<p>3.将远程机器的内容拷贝到本地机器
使用一个远程shell程序（如rsh、ssh）来实现将远程机器的内容拷贝到本地机器。当SRC地址路径包含单个冒号”:”分隔符时启动该模式。
[root@localhost ~]# <code>rsync -av 192.168.0.24:/home/feiyu/  /home/feiyu/</code></p>

<p><strong>注意</strong>：rsync命令使用中，如果源参数的末尾有斜线，就会复制指定目录的内容，而不复制目录本身；没有斜线，则会复制目录本身；目标参数末尾的斜线没有作用；因此下面的命令
[root@localhost ~]# rsync -r /mydata/data /backups/ : 会把目录data直接同步至/backups目录中
[root@localhost ~]# rsync -r /mydata/data/ /backups/: 会把目录data/中的内容的同步至/backups目录中
- [ ] rsync -av ck/ root@qubuluo.com:       $PWD/ck/* &ndash;&gt; /root/
- [x] rsync -av ck  root@qubuluo.com:       $PWD/ck/* &ndash;&gt; /root/ck/
- [x] rsync -av ck/ root@qubuluo.com:ck     $PWD/ck/* &ndash;&gt; /root/ck/
- [ ] rsync -av ck  root@qubuluo.com:ck     $PWD/ck/* &ndash;&gt; /root/ck/ck/
后面三种模式都是在rsync作为服务器时才能使用的，下面就开始配置rsync作为一个服务。
三，配置rsync服务</p>

<p>配置一个简单的rsync服务并不复杂，但是我们安装好rsync后，并没有发现配置文件，所以你需要手动建立一些配置文件。rsync可以经由xinetd启动daemon，或者作为一个独立进程启动daemon。如果把它作为一个独立进程来启动，只需要运行命令：rsync –daemon即可；但是我们一般将其作为超级守护进程使用。下面是安装步骤：
1.安装并启动xinetd</p>

<p>[root@localhost ~]# yum -y install xinetd</p>

<p>[root@localhost ~]# ls  /etc/xinetd.d/    #rsync的xinetd配置文件已经存在
chargen-dgram   daytime-dgram   discard-dgram   echo-dgram   rsync          time-dgram
chargen-stream  daytime-stream  discard-stream  echo-stream  tcpmux-server  time-stream</p>

<ol>
<li>为rsync服务提供配置文件</li>
</ol>

<p>配置文件为/etc/rsyncd.conf，获取帮助的方式：man rsyncd.conf。配置文件需要定义一个全局配置和多个rsync共享配置。</p>

<p>[root@localhost ~]# cat  /etc/rsyncd.conf</p>

<h1 id="global-settings">Global Settings</h1>

<h1 id="port-873-端口号默认为873-可以不指定">port = 873   端口号默认为873，可以不指定</h1>

<p>uid = nobody  //指定当模块传输文件的守护进程UID
gid = nobody  //指定当模块传输文件的守护进程GID
use chroot = no  //使用chroot到文件系统中的目录中
max connections = 5   //最大并发连接数
strict modes = yes      #严格检查文件权限
pid file = /var/run/rsyncd.pid  //指定PID文件
lock file = /usr/local/rsyncd/rsyncd.lock  //指定支持max connection的锁文件，默认为/var/run/rsyncd.lock
log file = /var/log/rsyncd.log  //rsync 服务器的日志</p>

<h1 id="directory-to-be-synced">Directory to be synced</h1>

<p>[mydata]          //自定义模块
path = /mydata/data    //用来指定要备份的目录
ignore errors = yes    //可以忽略一些IO错误
read only = no  //设置no，客户端可以上传文件，yes是只读
write only = no  //no为客户端可以下载，yes 不能下载
hosts allow = 192.168.0.0/16  //可以连接的IP
hosts deny = *   //禁止连接的IP
list = false       //客户请求时，使用模块列表
uid = root
gid = root
auth users = myuser   //连接用户名，和linux系统用户名无关系
secrets file = /etc/rsyncd.passwd   //验证密码文件</p>

<p>说明（deny | allow 规则）：
1、二者都不出现时，默认为允许访问；
2、只出现hosts allow: 定义白名单；但没有被匹配到的主机由默认规则处理，即为允许；
3、只出现hosts deny： 定义黑名单；出现在名单中的都被拒绝；
4、二者同时出现：先检查hosts allow，如果匹配就allow，否则，检查hosts deny，如果匹配则拒绝；如二者均无匹配，则由默认规则处理，即为允许；
3.创建密码文件</p>

<p>文件格式(明文)： username : password</p>

<p>[root@localhost ~]# echo &ldquo;myuser:mypass&rdquo; &gt;  /etc/rsyncd.passwd</p>

<p>[root@localhost ~]# chmod 600 /etc/rsyncd.passwd     #权限必须为600</p>

<p>4.启动服务</p>

<p>[root@localhost ~]# service xinetd  start</p>

<p>5.使用方法 ( 后三种模式 )</p>

<p>a. 从远程rsync服务器中拷贝文件到本地机。当SRC路径信息包含”::”分隔符时启动该模式。</p>

<p>[root@localhost ~]# rsync -av myuser@192.168.0.23::mydata /tmp/     #myuser为rsync服务器的一个用户</p>

<p>b. 从本地机器拷贝文件到远程rsync服务器中。当DST路径信息包含”::”分隔符时启动该模式。</p>

<p>[root@localhost ~]# rsync -av install.log.syslog  myuser@192.168.0.23::mydata</p>

<p>c. 列远程机的文件列表。这类似于rsync传输，不过只要在命令中省略掉本地机信息即可。</p>

<p>[root@localhost ~]# rsync -av myuser@192.168.0.23::mydata</p>

<p>yum install rsync</p>

<p>创建rsyncd服务的配置文件</p>

<p>默认安装后，在/etc目录下，并不存在rsyncd目录，需要手动创建配置文件目录</p>

<p>makdir /etc/rsyncd</p>

<p>在/etc/rsyncd目录下创建如下文件</p>

<p>touch /etc/rsyncd/rsyncd.conf          #主配置文件
touch /etc/rsyncd/rsyncd.secrets       #用户名密码文件，一组用户一行，用户名和密码使用 : 分割
touch /etc/rsyncd/rsyncd.motd          #非必须，连接上rsyncd显示的欢迎信息，此文件可不创建</p>

<p>必须注意的是，rsyncd服务的密码文件权限必须是600</p>

<p>chmod 0600 /etc/rsyncd/rsyncd.secrets</p>

<p>编辑主配置文件 rsyncd.conf</p>

<pre><code class="language-sh">######################################################################################################
#                      ******进程相关全局配置******
######################################################################################################
# = 后面的值可根据自己的实际情况更改
#    pid file 守护进程pid文件
#    port 守护进程监听端口，可更改，由xinetd允许rsyncd时忽略此参数
#    address 守护进程监听ip，由xinetd允许rsyncd时忽略此参数
pid file = /usr/local/var/run/rsyncd.pid
port = 873
address = 192.168.1.2
#rsyncd 守护进程运行系统用户全局配置，也可在具体的块中独立配置,
uid = root
gid = root
#允许 chroot，提升安全性，客户端连接模块，首先chroot到模块path参数指定的目录下
#chroot为yes时必须使用root权限，且不能备份path路径外的链接文件
use chroot = yes
#只读
read only = no
#只写
write only = no
#允许访问rsyncd服务的ip，ip端或者单独ip之间使用空格隔开
hosts allow = 192.168.0.1/255.255.255.0 198.162.145.1 10.0.1.0/255.255.255.0
#不允许访问rsyncd服务的ip，*是全部(不涵盖在hosts allow中声明的ip，注意和hosts allow的先后顺序)
hosts deny = *
#客户端最大连接数
max connections = 5
#欢迎文件路径，可选的
#motd file = /etc/rsyncd/rsyncd.motd
#日志相关
#    log file 指定rsync发送消息日志文件，而不是发送给syslog，如果不填这个参数默认发送给syslog
#    transfer logging 是否记录传输文件日志
#    log format 日志文件格式，格式参数请google
#    syslog facility rsync发送消息给syslog时的消息级别，
#    timeout连接超时时间
log file = /usr/local/logs/rsyncd.log
transfer logging = yes
log format = %t %a %m %f %b
syslog facility = local3
timeout = 300

######################################################################################################
#                      ******模块配置(多个)******
######################################################################################################
#模块 模块名称必须使用[]环绕，比如要访问data1,则地址应该是data1user@192.168.1.2::data1
[data1]
#模块根目录，必须指定
path=/home/username
#是否允许列出模块里的内容
list=yes
#忽略错误
#ignore errors
#模块验证用户名称，可使用空格或者逗号隔开多个用户名
auth users = data1user
#模块验证密码文件 可放在全局配置里
secrets file=/etc/rsyncd/rsyncd.secrets
#注释
comment = some description about this moudle
#排除目录，多个之间使用空格隔开
exclude = test1/ test2/
</code></pre>

<p>可以直接copy上述内容，作为自己rsyncd服务的配置模板</p>

<p>启动rsyncd服务</p>

<pre><code>rsyncd 服务负载比较高的时候，设定rsyncd为独立的守护进程
</code></pre>

<p>#默认配置文件是/etc/rsyncd.conf，所以需要显式的指定配置文件
/usr/bin/rsync &ndash;daemon &ndash;config=/etc/rsyncd/rsyncd.conf
#假设使用putty，xshell终端操作,保证终端断开进程仍然执行
nohup /usr/bin/rsync &ndash;daemon &ndash;config=/etc/rsyncd/rsyncd.conf</p>

<p>为了保证开机时自动启动，需要手动加上面的命令(/usr/bin/rsync &ndash;daemon &ndash;config=/etc/rsyncd/rsyncd.conf)加入 /etc/rc.local 文件中
如果服务器开启了防火墙，必须保证端口能穿过防火墙</p>

<p>iptables -A INPUT -p tcp -m state &ndash;state NEW  -m tcp &ndash;dport 873 -j ACCEPT</p>

<p>端口号修改为实际端口号即可</p>

<pre><code>rsyncd 使用xinetd运行
xinetd的rsync配置文件是/etc/xinetd.d/rsync
需要编辑此文件修改一个参数,显式的指定rsyncd服务的配置文件
</code></pre>

<p>server_args     = &ndash;daemon &ndash;config=/etc/rsyncd/rsyncd.conf</p>

<p>注意系统如果没有安装xinetd，需要 yum intall xinetd</p>

<p>chkconfig rsync on
service xinetd restart</p>

<p>使用rsync传输数据</p>

<p>示例1:</p>

<p>rsync -avzP data1user@192.168.1.2::data1 ~/data1</p>

<p>保持传输原有文件权限，用户，用户组，时间，递归的把data1模块数据复制到用户家目录的data1目录里，
参数 a的意思就是 保留文件原有权限，用户，用户组，时间且递归的copy包括链接文件，块设备在内的所有文件，这个参数很常用
参数 v是显示传输信息
参数 P显示传输进度
参数 z是压缩传输内容进行传输</p>

<p>假设要保持data1模块和用户家目录模块内容完全一致,加上参数 &ndash;delete,这样会删除在~/data1目录里但是不在data1模块里的文件(夹)</p>

<p>rsync -avzP &ndash;delete data1user@192.168.1.2::data1 ~/data1</p>

<p>示例2：</p>

<p>rsync -avzP &ndash;delete &ndash;password-file=/~/rsync/data1.secrets data1user@192.168.1.2::data1 ~/data1</p>

<h2 id="传输时自动使用密码文件而不用手动输入-注意密码文件权限必须是600">传输时自动使用密码文件而不用手动输入，注意密码文件权限必须是600</h2>

<p>[不带任何选项]</p>

<p>我们经常这样使用rsync：</p>

<p>$ rsync main.c machineB:/home/userB</p>

<p>1 只要目的端的文件内容和源端不一样，就会触发数据同步，rsync会确保两边的文件内容一样。
2 但rsync不会同步文件的“modify time”，凡是有数据同步的文件，目的端的文件的“modify time”总是会被修改为最新时刻的时间。
3 rsync不会太关注目的端文件的rwx权限，如果目的端没有此文件，那么权限会保持与源端一致；如果目的端有此文件，则权限不会随着源端变更。
4 只要rsync有对源文件的读权限，且对目标路径有写权限，rsync就能确保目的端文件同步到和源端一致。
5 rsync只能以登陆目的端的账号来创建文件，它没有能力保持目的端文件的输主和属组和源端一致。（除非你使用root权限，才有资格要求属主一致、属组一致）</p>

<p>[-t选项]</p>

<p>我们经常这样使用-t选项：</p>

<p>$ rsync -t main.c machineB:/home/userB</p>

<p>1 使用-t选项后，rsync总会想着一件事，那就是将源文件的“modify time”同步到目标机器。</p>

<p>2 带有-t选项的rsync，会变得更聪明些，它会在同步前先对比两边文件的时间戳和文件大小，如果一致，则就认为两边文件一样，对此文件就不再采取更新动作了。
3 因为rsync的聪明，也会反被聪明误。如果目的端的文件的时间戳、大小和源端完全一致，但是内容恰巧不一致时，rsync是发现不了的。这就是传说中的“坑”！
4 对于rsync自作聪明的情况，解决办法就是使用-I选项。</p>

<p>[-I选项]</p>

<p>我们经常这样使用-I选项：</p>

<p>$ rsync -I main.c machineB:/home/userB</p>

<p>1 -I选项会让rsync变得很乖很老实，它会挨个文件去发起数据同步。
2 -I选项可以确保数据的一致性，代价便是速度上会变慢，因为我们放弃了“quick check”策略。（quick check策略，就是先查看文件的时间戳和文件大小，依次先排除一批认为相同的文件）
3 无论情况如何，目的端的文件的modify time总会被更新到当前时刻。</p>

<p>【-v选项】</p>

<p>这个选项，简单易懂，就是让rsync输出更多的信息，我们可以举一个例子：</p>

<p>$ rsync -vI main.c machineB:/home/userB<br />
main.c</p>

<p>sent 81 bytes  received 42 bytes  246.00 bytes/sec
total size is 11  speedup is 0.09</p>

<p>你增加越多的v，就可以获得越多的日志信息。</p>

<p>$ rsync -vvvvt abc.c machineB:/home/userB</p>

<h2 id="z选项">[-z选项]</h2>

<p>这是个压缩选项，只要使用了这个选项，rsync就会把发向对端的数据先进行压缩再传输。对于网络环境较差的情况下建议使用。</p>

<p>一般情况下，-z的压缩算法会和gzip的一样。</p>

<h2 id="a选项-等价于-rlptgod">[-a选项] 等价于 -rlptgoD</h2>

<p>1 -a选项是rsync里比较霸道的一个选项，因为你使用-a选项，就相当于使用了-rlptgoD这一坨选项。以一敌七，唯-a选项也。（在看了前文之后，你应该可以很轻松的理解这七个选项的作用了）
2 -a选项的学名应该叫做archive option，中文叫做归档选项。使用-a选项，就表明你希望采取递归方式来同步，且尽可能的保持各个方面的一致性。
3 但是-a选项也有阿克琉斯之踵，那就是-a无法同步“硬链接”情况。如果有这方面需求，要加上-H选项。</p>

<h2 id="r选项-递归同步文件夹">[-r选项] 递归同步文件夹</h2>

<p>我们在第一次使用rsync时，往往会遇到这样的囧境：</p>

<p>$ rsync superman machineB:/home/userB
skipping directory superman</p>

<p>如果你不额外告诉rsync你需要它帮你同步文件夹的话，它是不会主动承担的，这也正是rsync的懒惰之处。</p>

<p>所以，如果你真的想同步文件夹，那就要加上-r选项，即recursive（递归的、循环的），像这样：</p>

<p>$  rsync -r superman machineB:/home/userB</p>

<p>我们在上面的讲解中说过，如果时间戳和文件大小完全一致，只有文件内容不同，且你没有使用-I选项的话，那么，rsync是不会进行数据同步的。</p>

<p>那么，提个问题：“因为在Linux的世界里，文件夹也是文件，如果这类文件（文件夹）也只有内容不同，而时间戳和文件大小都相同，rsync会发现么？”</p>

<p>实验大家可以自己动手做，结论在这里告诉大家：</p>

<p>对于文件夹，rsync是会明察秋毫的，只要你加了-r选项，它就会恪尽职守的进入到文件夹里去检查，而不会只对文件夹本身做“quick check”的。</p>

<h2 id="l选项-保留软链接">[-l选项] 保留软链接</h2>

<p>如果我们要同步一个软链接文件，你猜rsync会提示什么？</p>

<p>$ ll
total 128
-rw-rw-r&ndash;  1 userA userA 11 Dec 26 07:00 abc.c
lrwxrwxrwx  1 userA userA  5 Dec 26 11:35 softlink -&gt; abc.c
$ rsync softlink machineB:/home/userB
skipping non-regular file &ldquo;softlink&rdquo;</p>

<p>嗯，你猜对了，rsync又无情地拒绝了我们。它一旦发现某个文件是软链接，就会无视它，除非我们增加-l选项。</p>

<p>$ rsync -l softlink machineB:/home/userB</p>

<p>使用了-l选项后，rsync会完全保持软链接文件类型，原原本本的将软链接文件复制到目的端，而不会“follow link”到指向的实体文件。</p>

<p>如果我偏偏就想让rsync采取follow link的方式，那就用-L选项就可以了。你可以自己试试效果。</p>

<h2 id="p选项-保持权限一致">[-p选项] 保持权限一致</h2>

<p>这个选项的全名是“perserve permissions”，顾名思义，就是保持权限。</p>

<p>如果你不使用此选项的话，rsync是这样来处理权限问题的：</p>

<p>1 如果目的端没有此文件，那么在同步后会将目的端文件的权限保持与源端一致；
2 如果目的端已存在此文件，那么只会同步文件内容，权限保持原有不变。</p>

<p>如果你使用了-p选项，则无论如何，rsync都会让目的端保持与源端的权限一致的。</p>

<h2 id="g选项和-o选项">[-g选项和-o选项]</h2>

<p>这两个选项是一对，用来保持文件的属组(group)和属主（owner），作用应该很清晰明了。不过要注意的一点是，改变属主和属组，往往只有管理员权限才可以。</p>

<h2 id="d选项">[-D选项]</h2>

<p>-D选项，原文解释是“preserve devices(root only)”，从字面意思看，就是保持设备文件的原始信息。由于博主没有实际体验过它的好处，所以没有太多发言权。</p>

<p>[–delete选项、–delete-excluded选项和–delete-after选项]</p>

<p>三个选项都是和“删除”有关的：</p>

<p>1 –delete：如果源端没有此文件，那么目的端也别想拥有，删除之。（如果你使用这个选项，就必须搭配-r选项一起）
2 –delete-excluded：专门指定一些要在目的端删除的文件。
3 –delete-after：默认情况下，rsync是先清理目的端的文件再开始数据同步；如果使用此选项，则rsync会先进行数据同步，都完成后再删除那些需要清理的文件。</p>

<p>看到这么多delete，你是否有点肝颤？ 的确，在rsync的官方说明里也有这么一句话：</p>

<p>This option can be dangerous if used incorrectly!<br />
It is a very good idea to run first using the dry  run  option
(-n) to see what files would be deleted to make sure
important files aren&rsquo;t listed.</p>

<p>从这句话里，我们学到了一个小技巧，那就是-n选项，它是一个吓唬人的选项，它会用受影响的文件列表来警告你，但不会真的去删除，这就让我们有了确认的机会和回旋的余地。我们看看实际用法吧：</p>

<p>$ rsync -n &ndash;delete -r . machineB:/home/userB/
deleting superman/xxx
deleting main.c
deleting acclink</p>

<p>[–exclude选项和–exclude-from选项]</p>

<p>如果你不希望同步一些东西到目的端的话，可以使用–exclude选项来隐藏，rsync还是很重视大家隐私的，你可以多次使用–exclude选项来设置很多的“隐私”。</p>

<p>如果你要隐藏的隐私太多的话，在命令行选项中设置会比较麻烦，rsync还是很体贴，它提供了–exclude-from选项，让你可以把隐私一一列在一个文件里，然后让rsync直接读取这个文件就好了。</p>

<p>[–partial选项]</p>

<p>这就是传说中的断点续传功能。默认情况下，rsync会删除那些传输中断的文件，然后重新传输。但在一些特别情况下，我们不希望重传，而是续传。</p>

<p>我们在使用中，经常会看到有人会使用-P选项，这个选项其实是为了偷懒而设计的。以前人们总是要手动写–partial –progress，觉得太费劲了，倒不如用一个新的选项来代替，于是-P应运而生了。有些读者会问–partial我知道作用了，可–progress是干什么用的呢？为什么很多人要使用它呢，它有那么大的吸引力？（真有…）</p>

<p>[–progress选项]</p>

<p>使用这个选项，rsync会显示出传输进度信息，有什么用呢，rsync给了一个很有意思的解释：</p>

<p>This gives a bored user something to watch.</p>

<p>好了，写了这么多，大家看的已经很乏味了，去实际用用–progress解解闷，是个不错的选择</p>

<p>rsync服务器端配置文件详解</p>

<p>[root@ju ~]# vim /etc/rsyncd.conf</p>

<pre><code class="language-sh">uid = root         #rsync使用的用户
gid = root         #rsync使用的组
use chroot = no    #rsync的一个安全配置，如果为true，daemon进车会在给client端传输文件前chroot to the path。一般在内网不用配置
max connections = 100             #设置最大连接数，默认0为无限制
timeout = 300                     #超时时间，单位为秒
pid file = /var/run/rsyncd.pid    #pid文件配置
lock file = /var/run/rsync.lock   #锁文件配置
log file = /var/log/rsyncd.log    #log配置
[data]
path = /data/          #同步过来的文件存放位置
ignore errors          #忽略IO错误
read only = true       #指定client端是否可以上传文件，默认true
list = false           #是否允许client端查看可用模块列表，默认可以
hosts allow = 192.168.100.0/24  #允许的client端连接过来的网段
hosts deny = 0.0.0.0/32   #指定不能连接到服务器的client端网段，默认都可以连接
auth users = rsyncuser    #指定哪些用户可以连接，无需本地用户
secrets file = /etc/rsync.pass     #连接的密码文件路径，该文件内容为，user:password，如：rsyncuser:123456。当然也可以写多行。在客户端需要有一个文件记录密码（只要密码，并且文件权限为600）.

</code></pre>

<p>rsync服务默认端口是873
rsync服务启动参数：</p>

<p>&ndash;daemon      #以守护进程方式启动
&ndash;address     #绑定启动的ip地址
&ndash;config      #指定配置文件启动
&ndash;port        #指定端口启动</p>

<p>一般情况都只用 rsync &ndash;daemon</p>

<p>客户端执行同步命令：
rsync -ac /data/app-img/ rsyncuser@192.168.111.82::app-bak &ndash;password-file=/etc/rsync.secr</p>

<p>一般都使用avz选项（如果windows与linux同步不建议使用这个参数）</p>

<p>rsync是Unix下的一款应用软件，它能同步更新两处计算机的档案与目录，并适当利用差分编码以减少数据传输。rsync中一项与其他大部分类似程式或协定中所未见的重要特性是镜像对每个目标只需要一次传送。rsync可拷贝／显示目录属性，以及拷贝档案，并可选择性的压缩以及递归拷贝。</p>

<p>比如网站搬家只需要使用一行命令，填入系统密码即可。同步远程服务器上的文件夹到本地，如果本地有的文件，远程没有，则删除之。</p>

<p>rsync -ave &ldquo;ssh -p 22 -l root&rdquo; &ndash;delete 192.168.0.200:/www/web/ /www/web/</p>

<p>在常驻模式（daemon mode）下，rsync默认监听TCP埠873，以原生rsync传输协定或者透过远程shell如RSH或者SSH伺服档案。SSH情况下，rsync用户端执行程式必须同时在本地和远程机器上安装。</p>

<p>Rsync 的特色：</p>

<pre><code>快速：第一次同步时 rsync 会复制全部内容，但在下一次只传输修改过的文件。
安全：rsync 允许通过 ssh 协议来加密传输数据。
更少的带宽：rsync 在传输数据的过程中可以实行压缩及解压缩操作，因此可以使用更少的带宽。
特权：安装和执行 rsync 无需特别的权限
</code></pre>

<p>基本语法：rsync options source destination</p>

<p>源和目标都可以是本地或远程，在进行远程传输的时候，需要指定登录名、远程服务器及文件位置</p>

<p>样例：</p>

<p>1 在本地机器上对两个目录进行同步</p>

<p>rsync -zvr /var/opt/installation/inventory/ /root/temp</p>

<p>参数：</p>

<pre><code>-z 开启压缩
-v 详情输出
-r 表示递归
</code></pre>

<p>2 利用 rsync -a 让同步时保留时间标记</p>

<p>rsync 选项 -a 称为归档模式，执行以下操作</p>

<pre><code>递归模式
保留符号链接
保留权限
保留时间标记
保留用户名及组名
</code></pre>

<p>rsync -azv /var/opt/installation/inventory/ /root/temp/</p>

<p>3 仅同步一个文件</p>

<p>rsync -v /var/lib/rpm/Pubkeys /root/temp/</p>

<p>4 从本地同步文件到远程服务器</p>

<p>rsync -avz /root/temp/ root@192.168.200.10:/home/root/temp/
就像你所看到的，需要在远程目录前加上 ssh 登录方式，格式为 username@machinename:path</p>

<p>5 同步远程文件到本地</p>

<p>和上面差不多，做个相反的操作
rsync -avz root@192.168.200.10:/var/lib/rpm /root/temp</p>

<p>同步远程服务器上的文件夹到本地，如果本地有的文件，远程没有，则删除之。</p>

<p>rsync -rave &ldquo;ssh -p 22 -l root&rdquo; &ndash;delete 192.168.0.200:/www/web/ /www/web/</p>

<p>6 同步时指定远程 shell</p>

<p>用 -e 参数可以指定远程 ssh ，比如用 rsync -e ssh 来指定为 ssh</p>

<p>rsync -avz -e ssh root@192.168.200.10:/var/lib/rpm /root/temp</p>

<p>7 不要覆盖被修改过的目的文件
使用 rsync -u 选项可以排除被修改过的目的文件</p>

<p>rsync -avzu root@192.168.200.10:/var/lib/rpm /root/temp</p>

<p>8 仅仅同步目录权（不同步文件）
使用 -d 参数</p>

<p>rsync -v -d root@192.168.200.10:/var/lib/</p>

<p>9 查看每个文件的传输进程
使用 – -progress 参数</p>

<p>rsync -avz –-progress root@192.168.200.10:/var/lib/rpm/ /root/temp/</p>

<p>10 删除在目的文件夹中创建的文件
用 – -delete 参数</p>

<p>rsync -avz – -delete root@192.168.200.10:/var/lib/rpm/</p>

<p>11 不要在目的文件夹中创建新文件
有时能只想同步目的地中存在的文件，而排除源文件中新建的文件，可以使用 – -exiting 参数</p>

<p>rsync -avz –existing root@192.168.1.2:/var/lib/rpm/</p>

<p>12 查看源和目的文件之间的改变情况</p>

<p>用 -i 参数</p>

<p>rsync -avzi root@192.168.200.10:/var/lib/rpm/ /root/temp/</p>

<p>输出结果中在每个文件最前面会多显示 9 个字母，分别表示为
&gt; 已经传输
f 表示这是一个文件
d 表示这是一个目录
s 表示尺寸被更改
t 时间标记有变化
o 用户被更改
g 用户组被更改</p>

<p>13 在传输时启用包含和排除模式</p>

<p><code>rsync -avz – -include ‘P*’ – -exclude ‘*’ root@192.168.200.10:/var/lib/rpm/ /root/temp/</code></p>

<p>14 不要传输大文件</p>

<p>使用 – – max-size 参数</p>

<p>rsync -avz – -max-size=’100K’ root@192.168.200.10:/var/lib/rpm/ /root/temp/</p>

<p>15 传输所有文件</p>

<p>不管有没有改变，再次把所有文件都传输一遍，用 -W 参数</p>

<p>rsync -avzW root@192.168.200.10:/var/lib/rpm/ /root/temp</p>

<p>使用常驻模式，让备份服务器自动获取增量备份。
rsync软件一般系统都会自带，如果没有自带请自行安装即可。安装完毕后我们开始配置.</p>

<p>大致流程：1、建立配置文件  2、设置权限 3、添加排除的文件夹或文件 4、启动rsync的daemon mode</p>

<p>配置文件：
1、rsync的主配置文件。</p>

<p>/etc/rsync/rsyncd.conf</p>

<p>配置文件内容为：</p>

<pre><code class="language-sh">uid = www
gid = www
read only = true
transfer logging = true
max connections = 10
slp refresh = 300
hosts allow = 8.8.8.8
pid file = /var/run/rsyncd.pid
lock file = /var/run/rsyncd.lock
#log file = /var/log/rsyncd.log
#log format = %h %o %f %l %b

[web]
path = /www/web
comment = Mirror to us backup server
read only = true
list = false
auth users = zhangshan
secrets file = /etc/rsync/pass.conf
#exclude from = /etc/rsync/exclude.txt

[mysql]
path = /www/mysql
comment = Mirror to us MySql backup server
read only = true
list = false
auth users = zhangshan
secrets file = /etc/rsync/pass.conf
</code></pre>

<p>2、rsync的验证密码配置文件</p>

<p>mkdir /etc/rsync
vim /etc/rsync/pass.conf</p>

<p>填入用户名密码</p>

<p>zhangshan:zspassword</p>

<p>设置密码文件（/etc/rsync/pass.conf）的权限为600</p>

<p>chmod 600 /etc/rsync/pass.conf</p>

<p>3、目录排除文件</p>

<p>/etc/rsync/exclude.txt</p>

<p>文件内容为：一行一个要排除的目录</p>

<p>/www/www.abc.com/cache
/www/www.123.com</p>

<p>4、启动rsync服务器.</p>

<p>rsync &ndash;daemon &ndash;config=/etc/rsync/rsyncd.conf</p>

<p>客户机的配置过程：
1、建立密码文件并设置600权限。</p>

<p>mkdir /etc/rsync
/etc/rsync/pass.conf</p>

<p>文件内容为“密码”。注意，只填密码，否则会报1530错误。</p>

<p>zspassword</p>

<p>chmod 600 /etc/rsync/pass.conf</p>

<p>2、启动客户端</p>

<p>rsync -avzP &ndash;delete &ndash;password-file=/etc/rsync/pass.conf zhangshan@8.8.8.8::web /www/mirror</p>

<p>命令说明：同步服务器web模块中配置的目录到本地目录的/www/mirror，如果本地没有的文件，这复制过来。如果本地和服务器的文件一致，则不复制。如果本地文件较旧或者较新，这替换掉本地的文件。</p>

                      
                    </div>
                    <div style="border: 1px dashed #e0e0e0; padding: 10px 10px 10px 10px; background-color: #fffeee; background-repeat: no-repeat; background-attachment: scroll; background-position: 1% 50%; -moz-background-size: auto auto; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
    <div style="float:left;margin-top:0px;">
    <img src="//blog.pytool.com/public/qrcode.jpg" width="129px" height="129px"/>
    <div style="text-align:center;">微信扫一扫交流</div>
    </div>
    <div>
        <p style="margin-top:0px;">作者：<a target="_blank" href="http://blog.pytool.com/">rinetd</a>
        
        <br />本文出处：<a target="_blank" href="//blog.pytool.com/cmd/2016-01-01-linux%E5%91%BD%E4%BB%A4-rsync/">//blog.pytool.com/cmd/2016-01-01-linux%E5%91%BD%E4%BB%A4-rsync/</a>
        <br />
        文章版权归本人所有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文连接，否则保留追究法律责任的权利。 </p>
    </div>
</div>

                    <div class="clear"></div>
                  </div>
                  

                </div>
                
              </article>
              
              <div class="clear"></div>
              

              
<section id="comments" class="themeform">
  <div id="SOHUCS"></div>
	<script type="text/javascript">
	(function(){
		if (window.location.hostname === 'localhost') return;
		if (window.location.hostname === '127.0.0.1') return;

		var appid = 'cytgPrsTW';
		var conf = 'prod_a8b514a0c64b034bba38e466be98c266';
		var width = window.innerWidth || document.documentElement.clientWidth;
		if (width < 960) {window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); }
	})();
	</script>

  

  



  


</section>

            </div>
          </section>
          <div class="sidebar s1">
  <a class="sidebar-toggle" title="Expand Sidebar"><i class="fa icon-sidebar-toggle"></i></a>
  <div class="sidebar-content">
    <div class="sidebar-top group">
      <p>Follow:</p>
      <ul class="social-links">
    <li>
    <a class="social-tooltip" title="On WeiBo"
        href="http://weibo.com/rinetd" target="_blank">
        <i class="fa fa-weibo"></i>
    </a>
    </li>
    <li>
    <a class="social-tooltip" title="On Twitter" rel="nofollow"
        href="https://twitter.com/rinetd" target="_blank">
        <i class="fa fa-twitter"></i>
    </a>
    </li>
    <li>
    <a class="social-tooltip" title="On GitHub"
        href="https://github.com/rinetd" target="_blank">
        <i class="fa fa-github"></i>
    </a>
    </li>
</ul>

    </div>

    <ul class="post-nav group">
    <li class="previous">
      
      <a href="//blog.pytool.com/cmd/2016-01-01-linux%E5%91%BD%E4%BB%A4-iproute2/" rel="prev">
        <i class="fa fa-chevron-left"></i>
        <strong>Previous Post</strong>
        <span>Linux命令 route</span>
      </a>
      
  </li>
</ul>

    <div id="categories-2" class="widget widget_categories"><h3>分类</h3>
  <ul>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/android/">Android</a>
        <small>(16)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/android%E5%BA%95%E5%B1%82/">Android底层</a>
        <small>(7)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/english/">English</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/golang/">Golang</a>
        <small>(57)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/lessons/">Lessons</a>
        <small>(17)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/linux%E5%86%85%E6%A0%B8/">Linux内核</a>
        <small>(4)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/linux%E5%91%BD%E4%BB%A4/">Linux命令</a>
        <small>(90)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/linux%E5%9F%BA%E7%A1%80/">Linux基础</a>
        <small>(90)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/stm32/">Stm32</a>
        <small>(5)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/%E4%B8%AD%E5%8C%BB/">中医</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/">前端技术</a>
        <small>(3)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/%E5%A5%87%E7%9C%9F%E5%BC%82%E5%AE%9D/">奇真异宝</a>
        <small>(10)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/%E5%B5%8C%E5%85%A5%E5%BC%8Flinux/">嵌入式linux</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/">技术文章</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
        <small>(13)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/%E6%95%B0%E6%8D%AE%E7%AE%97%E6%B3%95/">数据算法</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91/">文本编辑</a>
        <small>(23)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a>
        <small>(2)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">正则表达式</a>
        <small>(3)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/%E7%A8%8B%E5%BA%8F%E5%91%98/">程序员</a>
        <small>(8)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/">端口转发</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a>
        <small>(44)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="//blog.pytool.com/categories/%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/">静态博客</a>
        <small>(11)</small>
      </li>
    
  </ul>
</div>

    
    
     
  <div id="search-2" class="widget widget_search"><h3>Search</h3>
      <form method="get" class="searchform themeform" action="https://www.google.com/search">
        <div>
          <input type="text" class="search" name="q" placeholder="Press enter to start searching">
        </div>
      </form>
    </div>
  </div>
  
</div>

          <div class="sidebar s2">
  <a class="sidebar-toggle" title="Expand Sidebar"><i class="fa icon-sidebar-toggle"></i></a>
  <div class="sidebar-content">
    <div class="sidebar-top group">
      <p>More</p>
    </div>

    
    <ul class="post-nav group">
    <li class="next">
      
      <a href="//blog.pytool.com/cmd/2016-01-01-linux%E5%91%BD%E4%BB%A4-scp/" rel="next">
        <i class="fa fa-chevron-right"></i>
        <strong>Next post</strong>
        <span>Linux命令 scp</span>
      </a>
      
  </li>
</ul>

    <div id="tag_cloud-2" class="widget widget_tag_cloud"><h3>标签云</h3>
  <div class="tagcloud post-tags">
      
         <a rel="tag" href="//blog.pytool.com/tags/ack/" class="tag-link-8" title="1 Posts">ack<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/activity/" class="tag-link-3" title="1 Posts">activity<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/adb/" class="tag-link-8" title="1 Posts">adb<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/ansible/" class="tag-link-4" title="1 Posts">ansible<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/apt/" class="tag-link-8" title="1 Posts">apt<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/aria2/" class="tag-link-6" title="1 Posts">aria2<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/arp/" class="tag-link-8" title="1 Posts">arp<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/atom/" class="tag-link-7" title="1 Posts">atom<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/autohotkey/" class="tag-link-1" title="1 Posts">autohotkey<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/awesome/" class="tag-link-4" title="1 Posts">awesome<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/awk/" class="tag-link-8" title="1 Posts">awk<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/bash/" class="tag-link-7" title="1 Posts">bash<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/bat/" class="tag-link-8" title="1 Posts">bat<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/bc/" class="tag-link-9" title="1 Posts">bc<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/bower/" class="tag-link-6" title="1 Posts">bower<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/burpssuite/" class="tag-link-1" title="1 Posts">burpssuite<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/burpsuite/" class="tag-link-2" title="1 Posts">burpsuite<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/capistrano/" class="tag-link-1" title="1 Posts">capistrano<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/cash/" class="tag-link-7" title="1 Posts">cash<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/centos7/" class="tag-link-4" title="1 Posts">centos7<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/coffeescript/" class="tag-link--1" title="1 Posts">coffeescript<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/composer/" class="tag-link-3" title="1 Posts">composer<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/coreos/" class="tag-link-5" title="1 Posts">coreos<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/crontab/" class="tag-link-4" title="1 Posts">crontab<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/cryptsetup/" class="tag-link-1" title="1 Posts">cryptsetup<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/css/" class="tag-link-8" title="1 Posts">css<small>(12)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/css3/" class="tag-link-7" title="1 Posts">css3<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/ctags/" class="tag-link-6" title="1 Posts">ctags<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/curl/" class="tag-link-7" title="1 Posts">curl<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/date/" class="tag-link-7" title="1 Posts">date<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/dd/" class="tag-link-9" title="1 Posts">dd<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/debug/" class="tag-link-6" title="1 Posts">debug<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/devops/" class="tag-link-5" title="1 Posts">devops<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/discourse/" class="tag-link-2" title="1 Posts">discourse<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/dnsmasq/" class="tag-link-4" title="1 Posts">dnsmasq<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/docker/" class="tag-link-5" title="1 Posts">docker<small>(8)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/dpkg/" class="tag-link-7" title="1 Posts">dpkg<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/editorconfig/" class="tag-link--1" title="1 Posts">editorconfig<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/emacs/" class="tag-link-6" title="1 Posts">emacs<small>(11)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/enca/" class="tag-link-7" title="1 Posts">enca<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/encode/" class="tag-link-5" title="1 Posts">encode<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/expect/" class="tag-link-5" title="1 Posts">expect<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/extundelete/" class="tag-link-0" title="1 Posts">extundelete<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/ffmpeg/" class="tag-link-5" title="1 Posts">ffmpeg<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/find/" class="tag-link-7" title="1 Posts">find<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/firewall/" class="tag-link-3" title="1 Posts">firewall<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/fonts/" class="tag-link-6" title="1 Posts">fonts<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/fstab/" class="tag-link-6" title="1 Posts">fstab<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/git/" class="tag-link-8" title="1 Posts">git<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/glang/" class="tag-link-6" title="1 Posts">glang<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/go/" class="tag-link-9" title="1 Posts">go<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/go-shadowsocks2/" class="tag-link--4" title="1 Posts">go-shadowsocks2<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/golang/" class="tag-link-5" title="1 Posts">golang<small>(57)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/gpg/" class="tag-link-8" title="1 Posts">gpg<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/gpio/" class="tag-link-7" title="1 Posts">gpio<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/grep/" class="tag-link-7" title="1 Posts">grep<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/hexdump/" class="tag-link-4" title="1 Posts">hexdump<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/hexo/" class="tag-link-7" title="1 Posts">hexo<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/hmac/" class="tag-link-7" title="1 Posts">hmac<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/html/" class="tag-link-7" title="1 Posts">html<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/html5/" class="tag-link-6" title="1 Posts">html5<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/http/" class="tag-link-7" title="1 Posts">http<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/httperf/" class="tag-link-4" title="1 Posts">httperf<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/hugo/" class="tag-link-7" title="1 Posts">hugo<small>(8)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/hydra/" class="tag-link-6" title="1 Posts">hydra<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/i18n/" class="tag-link-7" title="1 Posts">i18n<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/ifttt/" class="tag-link-6" title="1 Posts">ifttt<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/imagemagick/" class="tag-link-0" title="1 Posts">imagemagick<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/insomnia/" class="tag-link-3" title="1 Posts">insomnia<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/intent/" class="tag-link-5" title="1 Posts">intent<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/ios/" class="tag-link-8" title="1 Posts">ios<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/iotop/" class="tag-link-6" title="1 Posts">iotop<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/ip/" class="tag-link-9" title="1 Posts">ip<small>(10)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/iproute2/" class="tag-link-3" title="1 Posts">iproute2<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/iptables/" class="tag-link-3" title="1 Posts">iptables<small>(4)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/irc/" class="tag-link-8" title="1 Posts">irc<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/javascript/" class="tag-link-1" title="1 Posts">javascript<small>(6)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/join/" class="tag-link-7" title="1 Posts">join<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/js/" class="tag-link-9" title="1 Posts">js<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/linux/" class="tag-link-6" title="1 Posts">linux<small>(4)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/linux%E5%91%BD%E4%BB%A4/" class="tag-link-0" title="1 Posts">linux命令<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/locale/" class="tag-link-5" title="1 Posts">locale<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/losetup/" class="tag-link-4" title="1 Posts">losetup<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/lsof/" class="tag-link-7" title="1 Posts">lsof<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/lunr/" class="tag-link-7" title="1 Posts">lunr<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/lvm2/" class="tag-link-7" title="1 Posts">lvm2<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/makefile/" class="tag-link-3" title="1 Posts">makefile<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/mariadb/" class="tag-link-4" title="1 Posts">mariadb<small>(4)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/mathjax/" class="tag-link-4" title="1 Posts">mathjax<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/mbr/" class="tag-link-8" title="1 Posts">mbr<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/md5/" class="tag-link-8" title="1 Posts">md5<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/md5sum/" class="tag-link-5" title="1 Posts">md5sum<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/meteor/" class="tag-link-5" title="1 Posts">meteor<small>(7)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/mongodb/" class="tag-link-4" title="1 Posts">mongodb<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/mtr/" class="tag-link-8" title="1 Posts">mtr<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/mysql/" class="tag-link-6" title="1 Posts">mysql<small>(6)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/nessus/" class="tag-link-5" title="1 Posts">nessus<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/netcat/" class="tag-link-5" title="1 Posts">netcat<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/netsh/" class="tag-link-6" title="1 Posts">netsh<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/nexpose/" class="tag-link-4" title="1 Posts">nexpose<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/nginx/" class="tag-link-6" title="1 Posts">nginx<small>(26)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/nmap/" class="tag-link-7" title="1 Posts">nmap<small>(3)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/nodejs/" class="tag-link-5" title="1 Posts">nodejs<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/npm/" class="tag-link-8" title="1 Posts">npm<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/nvic/" class="tag-link-7" title="1 Posts">nvic<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/oauth2/" class="tag-link-5" title="1 Posts">oauth2<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/objdump/" class="tag-link-4" title="1 Posts">objdump<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/openssl/" class="tag-link-4" title="1 Posts">openssl<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/pandoc/" class="tag-link-5" title="1 Posts">pandoc<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/php/" class="tag-link-8" title="1 Posts">php<small>(3)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/postgresql/" class="tag-link-1" title="1 Posts">postgresql<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/powershell/" class="tag-link-1" title="1 Posts">powershell<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/prometheus/" class="tag-link-1" title="1 Posts">prometheus<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/proxy/" class="tag-link-6" title="1 Posts">proxy<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/python/" class="tag-link-5" title="1 Posts">python<small>(5)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/redis/" class="tag-link-6" title="1 Posts">redis<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/rename/" class="tag-link-5" title="1 Posts">rename<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/repo/" class="tag-link-7" title="1 Posts">repo<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/resin/" class="tag-link-6" title="1 Posts">resin<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/responsive/" class="tag-link-1" title="1 Posts">responsive<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/restful/" class="tag-link-4" title="1 Posts">restful<small>(4)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/rethinkdb/" class="tag-link-2" title="1 Posts">rethinkdb<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/retina/" class="tag-link-5" title="1 Posts">retina<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/root/" class="tag-link-7" title="1 Posts">root<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/route/" class="tag-link-6" title="1 Posts">route<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/rsync/" class="tag-link-6" title="1 Posts">rsync<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/rtsp/" class="tag-link-7" title="1 Posts">rtsp<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/ruby/" class="tag-link-7" title="1 Posts">ruby<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/samba/" class="tag-link-6" title="1 Posts">samba<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/sar/" class="tag-link-8" title="1 Posts">sar<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/scp/" class="tag-link-8" title="1 Posts">scp<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/scrapy/" class="tag-link-5" title="1 Posts">scrapy<small>(8)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/sed/" class="tag-link-8" title="1 Posts">sed<small>(3)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/selenium/" class="tag-link-3" title="1 Posts">selenium<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/sftp/" class="tag-link-7" title="1 Posts">sftp<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/shell/" class="tag-link-6" title="1 Posts">shell<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/snap/" class="tag-link-7" title="1 Posts">snap<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/sort/" class="tag-link-7" title="1 Posts">sort<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/ssh/" class="tag-link-8" title="1 Posts">ssh<small>(3)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/ssl/" class="tag-link-8" title="1 Posts">ssl<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/sso/" class="tag-link-8" title="1 Posts">sso<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/ssrf/" class="tag-link-7" title="1 Posts">ssrf<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/stm32/" class="tag-link-6" title="1 Posts">stm32<small>(5)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/sublime/" class="tag-link-4" title="1 Posts">sublime<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/sudo/" class="tag-link-7" title="1 Posts">sudo<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/svg/" class="tag-link-8" title="1 Posts">svg<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/swagger/" class="tag-link-4" title="1 Posts">swagger<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/swarm/" class="tag-link-6" title="1 Posts">swarm<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/systemctl/" class="tag-link-2" title="1 Posts">systemctl<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/tc/" class="tag-link-9" title="1 Posts">tc<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/tcpdump/" class="tag-link-4" title="1 Posts">tcpdump<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/tim/" class="tag-link-8" title="1 Posts">tim<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/time/" class="tag-link-7" title="1 Posts">time<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/timezone/" class="tag-link-3" title="1 Posts">timezone<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/tmux/" class="tag-link-7" title="1 Posts">tmux<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/top/" class="tag-link-8" title="1 Posts">top<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/tr/" class="tag-link-9" title="1 Posts">tr<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/tshark/" class="tag-link-5" title="1 Posts">tshark<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/ubuntu/" class="tag-link-5" title="1 Posts">ubuntu<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/ulimit/" class="tag-link-5" title="1 Posts">ulimit<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/underscore/" class="tag-link-1" title="1 Posts">underscore<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/unpack/" class="tag-link-5" title="1 Posts">unpack<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/update-alternatives/" class="tag-link--8" title="1 Posts">update-alternatives<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/useradd/" class="tag-link-4" title="1 Posts">useradd<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/vim/" class="tag-link-8" title="1 Posts">vim<small>(8)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/visualstudiocode/" class="tag-link--5" title="1 Posts">visualstudiocode<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/vlc/" class="tag-link-8" title="1 Posts">vlc<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/webpack3/" class="tag-link-3" title="1 Posts">webpack3<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/wget/" class="tag-link-7" title="1 Posts">wget<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/windows10/" class="tag-link-2" title="1 Posts">windows10<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/windump/" class="tag-link-4" title="1 Posts">windump<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/wireshark/" class="tag-link-2" title="1 Posts">wireshark<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/xidel/" class="tag-link-6" title="1 Posts">xidel<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/xml/" class="tag-link-8" title="1 Posts">xml<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/xmllint/" class="tag-link-4" title="1 Posts">xmllint<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/xpath/" class="tag-link-6" title="1 Posts">xpath<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/yaml/" class="tag-link-7" title="1 Posts">yaml<small>(2)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/%E5%93%8D%E5%BA%94%E5%BC%8F/" class="tag-link-2" title="1 Posts">响应式<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" class="tag-link--4" title="1 Posts">自动化测试<small>(1)</small></a>
      
         <a rel="tag" href="//blog.pytool.com/tags/%E8%B4%A6%E6%88%B7%E7%B3%BB%E7%BB%9F/" class="tag-link--1" title="1 Posts">账户系统<small>(1)</small></a>
      
  </div>
</div>

    

    
  </div>
</div>

        </div>
      </div>
    </div>
  </div>
</div>
<footer id="footer">
  <section class="container" id="footer-bottom">
    <div class="container-inner">
      <a id="back-to-top" href="#"><i class="fa fa-angle-up"></i></a>
      <div class="pad group">
        <div class="grid one-half">
          <div id="copyright">
              <p>Copyright (c) 2017. All rights reserved. (版权所有) <a href='http://www.miitbeian.gov.cn/'>鲁ICP备17074587号-1</a></p>
              
          </div>
          
        </div>
        
        <div class="grid one-half last">
          <ul class="social-links">
    <li>
    <a class="social-tooltip" title="On WeiBo"
        href="http://weibo.com/rinetd" target="_blank">
        <i class="fa fa-weibo"></i>
    </a>
    </li>
    <li>
    <a class="social-tooltip" title="On Twitter" rel="nofollow"
        href="https://twitter.com/rinetd" target="_blank">
        <i class="fa fa-twitter"></i>
    </a>
    </li>
    <li>
    <a class="social-tooltip" title="On GitHub"
        href="https://github.com/rinetd" target="_blank">
        <i class="fa fa-github"></i>
    </a>
    </li>
</ul>

        </div>
      </div>

    </div>
    
  </section>
  
</footer>



<script src="//blog.pytool.com/public/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
<script type="text/javascript" src="//blog.pytool.com/wp-content/themes/hueman/js/jquery.jplayer.min.js"></script>
<script type="text/javascript" src="//blog.pytool.com/wp-content/themes/hueman/js/scripts.js"></script>
<script type="text/javascript" src="//blog.pytool.com/assets/picturefill/picturefill.min.js"></script>
<script type="text/javascript" src="//blog.pytool.com/assets/js/jquery.matchHeight-min.js"></script>
<script type="text/javascript" async defer src="//blog.pytool.com/assets/js/myblog.js"></script>



<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-106129999-2', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>
<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?e2103759b6030b3c4ac84c63c542e493";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>

<script id="baidu_push">
  (function(){
    if (window.location.hostname === 'localhost') return;
    var bp = document.createElement('script'); bp.async = true;
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>

</body>
</html>

