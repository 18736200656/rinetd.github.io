<!DOCTYPE html>
<html lang="zh-CN" class="no-js">
<head>
  <meta charset="UTF-8">
  <base href="http://blog.pytool.com/">
  <script>
    document._writeOriginal = document.write;
    document.write = function(str) {
        if (str.indexOf('livereload.js') > -1) {
            document._writeOriginal(str);
        } else {
            document._writeOriginal('<!-- Be Hijack!! -->');
        }
    }
  </script>
<title>Linux命令 Dockerfile - 时光小栈</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

<meta name="description" content="http://www.cnblogs.com/52fhy/p/5638571.html dockerfile 剖析 ENV ENV 的就是给docker来设置变量的. 基本格式为: ENV name=jimmy age=18 修改环境变量 ENV PATH=$PATH:/user/bin 而通过 ENV 我们就可以完美的告诉docker 从这里开始,你就不能">
<meta name="author" content=rinetd>
<meta name="publisher" content=rinetd@163.com>

<meta itemprop="name" content="Linux命令 Dockerfile - 时光小栈">
<meta itemprop="description" content="http://www.cnblogs.com/52fhy/p/5638571.html dockerfile 剖析 ENV ENV 的就是给docker来设置变量的. 基本格式为: ENV name=jimmy age=18 修改环境变量 ENV PATH=$PATH:/user/bin 而通过 ENV 我们就可以完美的告诉docker 从这里开始,你就不能">
<meta itemprop="image" content="http://blog.pytool.com/public/avatar.png">

<meta property="og:type" content="article" />
<meta property="og:title" content="Linux命令 Dockerfile - 时光小栈" />
<meta property="og:description" content="http://www.cnblogs.com/52fhy/p/5638571.html dockerfile 剖析 ENV ENV 的就是给docker来设置变量的. 基本格式为: ENV name=jimmy age=18 修改环境变量 ENV PATH=$PATH:/user/bin 而通过 ENV 我们就可以完美的告诉docker 从这里开始,你就不能">
<meta property="og:image" content="http://blog.pytool.com/public/avatar.png" />
<meta property="og:url" content="http://blog.pytool.com/post/docker/2016-01-01-linux%E5%91%BD%E4%BB%A4-dockerfile/" />

<meta name="baidu-site-verification" content="pCInWQYbNT" />
<meta name="google-site-verification" content="ifeWsnNpU7w8vP3ii_Cjq-P9LKw3ngVitnMWv4XmJqk" />


<script>document.documentElement.className = document.documentElement.className.replace("no-js", "js");</script>
<link rel="canonical" href="http://blog.pytool.com/post/docker/2016-01-01-linux%E5%91%BD%E4%BB%A4-dockerfile/">
<link rel='shortlink' href="http://blog.pytool.com/post/docker/2016-01-01-linux%E5%91%BD%E4%BB%A4-dockerfile/"/>
<link rel="shortcut icon" href="http://blog.pytool.com/public/favicon.ico"/>

<link rel="stylesheet" id="human-style-css" href="http://blog.pytool.com/wp-content/themes/hueman/style.css" type="text/css" media="all"/>
<link rel="stylesheet" id="human-style-css1" href="http://blog.pytool.com/wp-content/themes/hueman/custom.css" type="text/css" media="all"/>
<link rel="stylesheet" id="human-style-css2" href="http://blog.pytool.com/wp-content/themes/hueman-child/style.css" type="text/css" media="all"/>
<link rel="stylesheet" id="responsive-css" href="http://blog.pytool.com/wp-content/themes/hueman/responsive.css" type="text/css" media="all"/>
<link rel="stylesheet" id="font-awesome-css" href="http://blog.pytool.com/wp-content/themes/hueman/fonts/font-awesome.min.css" type="text/css" media="all"/>

<link rel="stylesheet" href="http://blog.pytool.com/public/highlight/styles/github.css">
<link rel="stylesheet" id="human-style-css3" href="http://blog.pytool.com/wp-content/themes/hueman-child/user.css" type="text/css" media="all"/>
<link rel="stylesheet" href="http://blog.pytool.com/public/font/hack/css/hack.min.css">

</head>


<body class="single single-post single-format-standard col-3cm full-width topbar-enabled chrome">
<div id="wrapper">
  <header id="header">

  <nav class="nav-container group" id="nav-topbar">
    <div class="nav-toggle"><i class="fa fa-bars"></i></div>
    <div class="nav-text"></div>
    <div class="nav-wrap container">
      <a rel="nofollow" href="http://blog.pytool.com/" class="nav-cs-icon">
        <img width="40" height="40" src="http://blog.pytool.com/public/avatar.png" alt="rinetd" title="Home">
      </a>
      <ul id="menu-default-menu" class="nav container-inner group">
        <li class="menu-item menu-item-type-post_type menu-item-object-page">
          <a rel="nofollow" href="http://blog.pytool.com/">Home</a>
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="http://blog.pytool.com/basic/">Basic</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="http://blog.pytool.com/cmd/">Cmd</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="http://blog.pytool.com/edit/">Edit</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="http://blog.pytool.com/english/">English</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="http://blog.pytool.com/hacker/">Hacker</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="http://blog.pytool.com/hardware/">Hardware</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="http://blog.pytool.com/hugo/">Hugo</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="http://blog.pytool.com/linux/">Linux</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="http://blog.pytool.com/life/">Life</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="http://blog.pytool.com/post/">Post</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="http://blog.pytool.com/reship/">Reship</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="http://blog.pytool.com/seo/">SEO</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="http://blog.pytool.com/software/">Software</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="http://blog.pytool.com/tool/">Tool</a>
          
        </li>
        
          
          <li class="menu-item menu-item-type-post_type menu-item-object-page">
            <a rel="nofollow" href="http://blog.pytool.com/windows/">Windows</a>
          
        </li>
        
        
        <li class="menu-item menu-item-type-post_type menu-item-object-page">
          <a rel="nofollow" href="http://blog.pytool.com/post/">Post</a>
        </li>
        
        <li class="menu-item menu-item-type-post_type menu-item-object-page">
          <a rel="nofollow" href="http://blog.pytool.com/about/">about</a>
        </li>
        

        
      </ul>

    </div>

    <div class="container">
      <div class="container-inner">
        <div class="toggle-search"><i class="fa fa-search"></i></div>
        <div class="search-expand">
          <div class="search-expand-inner">
            <form method="get" class="searchform themeform" action="https://www.google.com/search">
              <div>
                <input type="text" class="search" name="q" placeholder="Press enter to start searching">
              </div>
            </form>
          </div>
        </div>
      </div>
      
    </div>
    

  </nav>
  

  <div class="container group">
    <div class="container-inner">
      <div class="group pad">
        <div class="group pad">
          <h1 class="site-title">
            <a rel="nofollow" href="http://blog.pytool.com/" rel="home">
              
              
            </a>
          </h1>
          <p class="site-description"> Don&#39;t put any lines in your CODE that you don&#39;t understand </p>
        </div>

      </div>
    </div>
    
  </div>
  

</header>



  <div class="container" id="page">
    <div class="container-inner">
      <div class="main">
        <div class="main-inner group">
          <section class="content">
            <div class="page-title pad group">
              <ul class="meta-single group">
                
                <li class="category">
                  <a href="http://blog.pytool.com/categories/linux%E5%9F%BA%E7%A1%80/" rel="category tag">Linux基础</a>
                </li>
                
              </ul>
            </div>

            <div class="pad group">

              <article
                  class="post type-post status-publish format-standard has-post-thumbnail hentry category-australien tag-bondi-beach tag-city2surf tag-sydney">
                <div class="post-inner group">

                  <h1 class="post-title">Linux命令 Dockerfile</h1>

                  <p class="post-byline">
                    by  · 2016年03月05日 15:30:01 · 15451 Words ·
                    ~31min reading time |
                    
                    <a href="https://coding.net/u/rinetd/p/blog/git/edit/master/content/Post/docker/2016-01-01%20Linux%e5%91%bd%e4%bb%a4%20Dockerfile.md" target="_blank">Improve on <i class="fa fa-git-square"></i></a>
                  </p>

                  <div class="clear"></div>

                  <div class="entry">
                    <div class="entry-inner">
                      
                      

<p><a href="http://www.cnblogs.com/52fhy/p/5638571.html" target="_blank">http://www.cnblogs.com/52fhy/p/5638571.html</a>
<a href="http://www.tuicool.com/articles/fUjyaq" target="_blank">dockerfile 剖析</a></p>

<h1 id="env-env-的就是给docker来设置变量的-基本格式为">ENV ENV 的就是给docker来设置变量的. 基本格式为:</h1>

<p>ENV name=jimmy age=18</p>

<h1 id="修改环境变量">修改环境变量</h1>

<p>ENV PATH=$PATH:/user/bin<br />
而通过 ENV 我们就可以完美的告诉docker 从这里开始,你就不能使用cache,自己的重新来.( 因为,每条指令都会生成layer并且有独立的id,一旦你更改的ENV,那么从该指令开始id都会发生改变,也就匹配不到缓存了 )</p>

<h1 id="arg-指定构建过程中使用的环境变">ARG 指定构建过程中使用的环境变</h1>

<p>添加个人信息LABEL</p>

<p>顾名思义,使用 LABEL 就是给你的image打上独一无二的标签.让别人能够了解,这个Image是属于你的. 又或是,用来提醒你自己,这个image现在处于哪一个版本状态.</p>

<h1 id="设置自己的label">设置自己的label</h1>

<p>LABEL owner=&ldquo;jimmy&rdquo; version=&ldquo;0.0.1&rdquo;</p>

<h1 id="在dockerfile定义了默认变量">在dockerfile定义了默认变量</h1>

<p>ARG user=jimy</p>

<h1 id="在运行时-进行手动替换">在运行时,进行手动替换</h1>

<p>docker build &ndash;build-arg user=sam -t jimmy/demo .</p>

<p>上面说了ARG和ENV比较类似,不过,里面的区别还是有的. 即, ARG只能用在 docker build 的阶段, 并且不会被保存在 image 中,这就是和ENV的区别.</p>

<p>##############Dockerfile#########################</p>

<h1 id="容器需要开放ssh-22端口">容器需要开放SSH 22端口</h1>

<p>EXPOSE 22<br />
!!!<br />
ENTRYPOINT，表示镜像在初始化时需要执行的命令，不可被重写覆盖，需谨记<br />
CMD，表示镜像运行默认参数，可被重写覆盖<br />
ENTRYPOINT/CMD都只能在文件中存在一次，并且最后一个生效 多个存在，只有最后一个生效，其它无效！<br />
需要初始化运行多个命令，彼此之间可以使用 &amp;&amp; 隔开，但最后一个须要为无限运行的命令，需切记！</p>

<p>ENTRYPOINT/CMD，一般两者可以配合使用，比如：</p>

<p>ENTRYPOINT [&ldquo;/usr/sbin/sshd&rdquo;]<br />
CMD [&ldquo;-D&rdquo;]</p>

<p>在Docker　daemon模式下，无论你是使用ENTRYPOINT，还是CMD，最后的命令，一定要是当前进程需要一直运行的，才能够防容器退出。</p>

<p>以下无效方式：</p>

<p>ENTRYPOINT service tomcat7 start #运行几秒钟之后，容器就会退出<br />
CMD service tomcat7 start #运行几秒钟之后，容器就会退出</p>

<p>这样有效：</p>

<p>ENTRYPOINT service tomcat7 start &amp;&amp; tail -f /var/lib/tomcat7/logs/catalina.out</p>

<h1 id="或者">或者</h1>

<p>CMD service tomcat7 start &amp;&amp; tail -f /var/lib/tomcat7/logs/catalina.out</p>

<p>这样也有效：</p>

<p>ENTRYPOINT [&ldquo;/usr/sbin/sshd&rdquo;]<br />
CMD [&ldquo;-D&rdquo;]</p>

<p>Capabilities的主要思想在于分割root用户的特权，即将root的特权分割成不同的能力，每种能力代表一定的特权操作。例如：能力CAP_SYS_MODULE表示用户能够加载(或卸载)内核模块的特权操作，而CAP_SETUID表示用户能够修改进程用户身份的特权操作。在Capbilities中系统将根据进程拥有的能力来进行特权操作的访问控制。<br />
    在Capilities中，只有进程和可执行文件才具有能力，每个进程拥有三组能力集，分别称为cap_effective, cap_inheritable, cap_permitted(分别简记为:pE,pI,pP)，其中cap_permitted表示进程所拥有的最大能力集；cap_effective表示进程当前可用的能力集，可以看做是cap_permitted的一个子集；而cap_inheitable则表示进程可以传递给其子进程的能力集。系统根据进程的cap_effective能力集进行访问控制，cap_effective为cap_permitted的子集，进程可以通过取消cap_effective中的某些能力来放弃进程的一些特权。可执行文件也拥有三组能力集，对应于进程的三组能力集，分别称为cap_effective, cap_allowed 和 cap_forced（分别简记为fE,fI,fP），其中，cap_allowed表示程序运行时可从原进程的cap_inheritable中集成的能力集，cap_forced表示运行文件时必须拥有才能完成其服务的能力集；而cap_effective则表示文件开始运行时可以使用的能力。<br />
（一）Linux内核中Capabilities的实现机制<br />
     Linux内核从2.2版本开始，就加进的Capabilities的概念与机制，并随着版本升高逐步得到改进。在linux中，root权限被分割成一下29中能力：<br />
CAP_CHOWN:修改文件属主的权限<br />
CAP_DAC_OVERRIDE:忽略文件的DAC访问限制<br />
CAP_DAC_READ_SEARCH:忽略文件读及目录搜索的DAC访问限制<br />
CAP_FOWNER：忽略文件属主ID必须和进程用户ID相匹配的限制<br />
CAP_FSETID:允许设置文件的setuid位<br />
CAP_KILL:允许对不属于自己的进程发送信号<br />
CAP_SETGID:允许改变进程的组ID<br />
CAP_SETUID:允许改变进程的用户ID<br />
CAP_SETPCAP:允许向其他进程转移能力以及删除其他进程的能力<br />
CAP_LINUX_IMMUTABLE:允许修改文件的IMMUTABLE和APPEND属性标志<br />
CAP_NET_BIND_SERVICE:允许绑定到小于1024的端口<br />
CAP_NET_BROADCAST:允许网络广播和多播访问<br />
CAP_NET_ADMIN:允许执行网络管理任务<br />
CAP_NET_RAW:允许使用原始套接字<br />
CAP_IPC_LOCK:允许锁定共享内存片段<br />
CAP_IPC_OWNER:忽略IPC所有权检查<br />
CAP_SYS_MODULE:允许插入和删除内核模块<br />
CAP_SYS_RAWIO:允许直接访问/devport,/dev/mem,/dev/kmem及原始块设备<br />
CAP_SYS_CHROOT:允许使用chroot()系统调用<br />
CAP_SYS_PTRACE:允许跟踪任何进程<br />
CAP_SYS_PACCT:允许执行进程的BSD式审计<br />
CAP_SYS_ADMIN:允许执行系统管理任务，如加载或卸载文件系统、设置磁盘配额等<br />
CAP_SYS_BOOT:允许重新启动系统<br />
CAP_SYS_NICE:允许提升优先级及设置其他进程的优先级<br />
CAP_SYS_RESOURCE:忽略资源限制<br />
CAP_SYS_TIME:允许改变系统时钟<br />
CAP_SYS_TTY_CONFIG:允许配置TTY设备<br />
CAP_MKNOD:允许使用mknod()系统调用<br />
CAP_LEASE:允许修改文件锁的FL_LEASE标志<br />
################################################################################</p>

<h2 id="docker-搭建android开发环境">docker 搭建Android开发环境</h2>

<p>docker pull ubuntu:10.04<br />
docker run -it -p 8080:80 -v /media/ubuntu/sdb2/Android:/mnt -w /mnt ubuntu:10.04 /bin/bash</p>

<p>docker ps -a<br />
docker start 8c055f32bd33<br />
docker attach 8c055f32bd33<br />
sudo vi /etc/apt/source.list<br />
sed -i &rsquo;s/httpredir.debian.org/mirrors.aliyun.com/g&rsquo; /etc/apt/sources.list</p>

<p>sudo sed -i &rsquo;s/archive.ubuntu.com/mirrors.sohu.com/g&rsquo; /etc/apt/sources.list<br />
sudo sed -i &rsquo;s/archive.ubuntu.com/mirrors.163.com/g&rsquo; /etc/apt/sources.list<br />
sudo sed -i &rsquo;s/archive.ubuntu.com/mirrors.ustc.edu.cn/g&rsquo; /etc/apt/sources.list<br />
sudo sed -i &rsquo;s/archive.ubuntu.com/mirrors.aliyun.com/g&rsquo; /etc/apt/sources.list<br />
sudo sed -i &rsquo;s/archive.ubuntu.com/mirrors.aliyuncs.com/g&rsquo; /etc/apt/sources.list #内网使用</p>

<pre><code>#网易  
deb http://mirrors.163.com/ubuntu/ lucid main universe restricted multiverse  
deb-src http://mirrors.163.com/ubuntu/ lucid main universe restricted multiverse  
deb http://mirrors.163.com/ubuntu/ lucid-security universe main multiverse restricted  
deb-src http://mirrors.163.com/ubuntu/ lucid-security universe main multiverse restricted  
deb http://mirrors.163.com/ubuntu/ lucid-updates universe main multiverse restricted  
deb http://mirrors.163.com/ubuntu/ lucid-proposed universe main multiverse restricted  
deb-src http://mirrors.163.com/ubuntu/ lucid-proposed universe main multiverse restricted  
deb http://mirrors.163.com/ubuntu/ lucid-backports universe main multiverse restricted  
deb-src http://mirrors.163.com/ubuntu/ lucid-backports universe main multiverse restricted  
deb-src http://mirrors.163.com/ubuntu/ lucid-updates universe main multiverse restricted  
</code></pre>

<p>sudo apt-get update</p>

<p>sudo apt-get install gnupg flex bison gperf build-essential \<br />
  zip curl zlib1g-dev libc6-dev lib32ncurses5-dev ia32-libs \<br />
  x11proto-core-dev libx11-dev lib32readline5-dev lib32z-dev \<br />
  libgl1-mesa-dev g++-multilib mingw32 tofrodos python-markdown \<br />
  libxml2-utils xsltproc</p>

<p><code>sudo apt-get install software-properties-common</code><br />
<code>sudo apt-get install python-software-properties</code><br />
  sudo add-apt-repository ppa:webupd8team/java    #添加PPA<br />
  sudo apt-get update<br />
  sudo apt-get install oracle-java6-installer     #java-6u45</p>

<p>sudo docker commit -m=&ldquo;Android source Complie&rdquo; -a=&ldquo;rinetd&rdquo; ab044db61af2 rinetd/ubuntu:v1<br />
docker tag 5db5f8471261 rinetd/ubuntu:devel<br />
docker push rinetd/ubuntu</p>

<p>Docker命令参考<br />
使用方法: docker [OPTIONS] COMMAND [arg&hellip;]</p>

<p>一个自给自足的运行时linux容器。</p>

<p>选项:<br />
  &ndash;api-enable-cors=false              在远程的API中启用CORS 头。<br />
  -b, &ndash;bridge=&ldquo;&rdquo;                      附加容器到一个已经存在的网桥上。如果将该选项的值设置为 &lsquo;none&rsquo;，则表示不使用用网桥。<br />
  &ndash;bip=&ldquo;&rdquo;                             设置网桥的IP地址，使用CIIDR标记方式的地址，不兼容 -b选项。<br />
  -D, &ndash;debug=false                    启用debug 模式。<br />
  -d, &ndash;daemon=false                   启用daemon 模式。<br />
  &ndash;dns=[]                             强制Docker使用特定的DNS 服务器。<br />
  &ndash;dns-search=[]                      强制 Docker使用特定的DNS 搜索域。<br />
  -e, &ndash;exec-driver=&ldquo;native&rdquo;           强制Docker运行时使用特定的exec驱动。<br />
  &ndash;fixed-cidr=&ldquo;&rdquo;                      IPv4子网设置掩码(ex: 10.20.0.0/16)，这个子网必须嵌套于网桥子网内(由-b 或者-bip定义)。<br />
  -G, &ndash;group=&ldquo;docker&rdquo;                 在使用-H运行为守护进程的情况下，设定分配给运行unix套接字的组，如果设置为&rdquo; (空字符)，那么将不会设置组。<br />
  -g, &ndash;graph=&ldquo;/var/lib/docker&rdquo;        设定Docker运行时作为根目录的目录路径。<br />
  -H, &ndash;host=[]                        设置用于在守护进程模式下或者是在客户端模式下连接的套接字，可以是tcp://host:port, unix:///path/to/socket, fd://* or fd://socketfd中的一个或者多。<br />
  &ndash;icc=true                           启用容器间通信。<br />
  &ndash;insecure-registry=[]               对于特定注册启用非安全通信(对于HTTPS没有证书校验，启用HTTP启用fallback) (例如, localhost:5000 or 10.20.0.0/16)。<br />
  &ndash;ip=0.0.0.0                         在容器绑定端口时使用的默认IP地址。<br />
  &ndash;ip-forward=true                    启用net.ipv4.ip_forward，也就是开启路由转发功能。<br />
  &ndash;ip-masq=true                       对于网桥的IP段启用ip伪装。<br />
  &ndash;iptables=true                      启用Docker增加的iptables规则。<br />
  &ndash;mtu=0                              设置容器网络的MTU。如果没有提供设置的值：默认将它的值设置为路由器的MTU，如果默认的路由器无效那么就设置为1500。<br />
  -p, &ndash;pidfile=&ldquo;/var/run/docker.pid&rdquo;  设置守护进程PID文件的路径。<br />
  &ndash;registry-mirror=[]                 指定优先使用的Docker registry镜像。<br />
  -s, &ndash;storage-driver=&ldquo;&rdquo;              强制Docker运行时使用特定的存储驱动器。<br />
  &ndash;selinux-enabled=false              启用对selinux机制的支持。SELinux目前不支持BTRFS存储驱动器。<br />
  &ndash;storage-opt=[]                     设置存储驱动器选项。<br />
  &ndash;tls=false                          使用TLS，暗示使用tls-verify标志。<br />
  &ndash;tlscacert=&ldquo;/root/.docker/ca.pem&rdquo;   设置ca证书的路径。远程访问仅信任使用由CA签名的证书。<br />
  &ndash;tlscert=&ldquo;/root/.docker/cert.pem&rdquo;   设置TLS 证书的路径。<br />
  &ndash;tlskey=&ldquo;/root/.docker/key.pem&rdquo;     设置TLS key 文件的路径。<br />
  &ndash;tlsverify=false                    使用TLS校验远程登录(daemon:校验客户端, client: 校验守护进程)<br />
  -v, &ndash;version=false                  显示版本信息并退出。</p>

<p>命令:<br />
attach    附加到一个运行的容器上。<br />
build     从Dockerfile构建镜像。<br />
commit    从改变后的容器创建一个新的镜像<br />
cp        从容器文件系统拷贝文件/目录到宿主机路径。<br />
create    创建一个新的容器。<br />
diff      检查容器文件系统的改变。<br />
events    从Get real time events from the server<br />
exec      在已经存在的容器上运行一个命令。<br />
export    Stream the contents of a container as a tar archive<br />
history   显示镜像的历史。<br />
images    列举镜像。<br />
import    从一个tar包的内容创建一个新的文件系统镜像。<br />
info      显示系统层面的信息。<br />
inspect   查看容器的底层信息。<br />
kill      杀掉一个正在运行中的容器。<br />
load      从tar文件中载入一个镜像。<br />
login     注册或者登录到Docker registry 服务器。<br />
logout    从Docker registry 服务器退出。<br />
logs      获取容器的日志信息。<br />
port      Lookup the public-facing port that is NAT-ed to PRIVATE_PORT<br />
pause     停止容器内所有的进程。<br />
ps        列出容器。<br />
pull      从Docker registry 服务器拉回一个镜像或者一个仓库。<br />
push      将一个镜像或者一个仓库推向Docker registry 服务器。<br />
restart   重新启动一个运行中的容器。<br />
rm        移除一个或者多个容器。<br />
rmi       移除一个或者多个镜像。<br />
run       在新的容器中运行一个命令。<br />
save      将镜像保存为一个tar文档。<br />
search    在Docker Hub上搜索一个镜像。<br />
start     启动一个停止的容器。<br />
stop      S停止一个运行中的容器。<br />
tag       Tag an image into a repository<br />
top       查看容器中运行的进程。<br />
unpause   取消暂停的容器。<br />
version   显示Docker 的版本信息。<br />
wait      Block until a container stops, then print its exit code</p>

<p>docker attach</p>

<p>使用方法: docker attach [OPTIONS] CONTAINER</p>

<p>附加到一个正在运行的容器上。</p>

<p>&ndash;no-stdin=false    不附加STDIN。<br />
  &ndash;sig-proxy=true    代理所有接收到的信号到进程(即使是非TTY模式)。SIGCHLD, SIGKILL, 或者 SIGSTOP 不会被代理。</p>

<p>docker build</p>

<p>使用方法: docker build [OPTIONS] PATH | URL | -</p>

<p>在指定的PATH源代码下构建新的镜像。</p>

<p>&ndash;force-rm=false     总是立即移除容器，即使是在成功创建之后。<br />
  &ndash;no-cache=false     在构建镜像时不使用缓存。<br />
  -q, &ndash;quiet=false    抑制由容器生成详细输出。<br />
  &ndash;rm=true            成功创建容器之后就立即删除。<br />
  -t, &ndash;tag=&ldquo;&rdquo;         指定仓库名字(和一个可选的标签)，在构建成功的镜像结果中应用。</p>

<p>docker commit</p>

<p>使用方法: docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]</p>

<p>从有改变的容器上创建一个新的镜像。</p>

<p>-a, &ndash;author=&ldquo;&rdquo;     作者 (例如 &ldquo;John Hannibal Smith <a href="mailto:hannibal@a-team.com" target="_blank">hannibal@a-team.com</a>&rdquo;<br />
  -m, &ndash;message=&ldquo;&rdquo;    提交信息。<br />
  -p, &ndash;pause=true    在提交的过程中暂停容器。</p>

<p>docker cp</p>

<p>使用方法: docker cp CONTAINERATH HOSTPATH</p>

<p>从PATH 拷贝文件/目录到 HOSTPATH。</p>

<p>docker create<br />
使用方法: docker create [OPTIONS] IMAGE [COMMAND] [ARG&hellip;]</p>

<p>创建一个新容器。</p>

<p>-a, &ndash;attach=[]            附加到STDIN, STDOUT 或者STDERR。<br />
  &ndash;add-host=[]              自定义一个主机到IP的映射(host:ip)。<br />
  -c, &ndash;cpu-shares=0         设定CPU共享(相对权重)。<br />
  &ndash;cap-add=[]               添加Linux capabilities。<br />
  &ndash;cap-drop=[]              移除 Linux capabilities。<br />
  &ndash;cidfile=&ldquo;&rdquo;               写容器ID的文件。<br />
  &ndash;cpuset=&ldquo;&rdquo;                设置使用CPU的数量(0-3, 0,1)。<br />
  &ndash;device=[]                添加一个主机设备到容器(例如<br />
&ndash;device=/dev/sdc:/dev/xvdc)<br />
  &ndash;dns=[]                   设置自定义DNS 服务器。<br />
  &ndash;dns-search=[]            设置自定义DNS 搜索域。<br />
  -e, &ndash;env=[]               设置环境变量。<br />
  &ndash;entrypoint=&ldquo;&rdquo;            覆盖掉镜像中默认的ENTRYPOINT。<br />
  &ndash;env-file=[]              读以逗号分隔的环境变量文件(文件中的行以逗号分隔，每一行都是环境变量)。<br />
  &ndash;expose=[]                将一个没有发布的端口暴露给宿主机。<br />
  -h, &ndash;hostname=&ldquo;&rdquo;          容器主机名字。<br />
  -i, &ndash;interactive=false    保持 STDIN 打开，即使没有被附加。<br />
  &ndash;link=[]                  以name:alias格式添加连接到其它容器上。<br />
  &ndash;lxc-conf=[]              (lxc exec-driver only) 添加自定义lxc 选项<br />
&ndash;lxc-conf=&ldquo;lxc.cgroup.cpuset.cpus = 0,1&rdquo;<br />
  -m, &ndash;memory=&ldquo;&rdquo;            内存限制 (格式: <number><optional unit>,<br />
unit = b, k, m or g)<br />
  &ndash;name=&ldquo;&rdquo;                  指定容器的名字。<br />
  &ndash;net=&ldquo;bridge&rdquo;             为容器设置网络模式，<br />
                               &lsquo;bridge&rsquo;: 在docker bridge桥上创建一个新的网络栈。<br />
                                 &lsquo;none&rsquo;: 该容器没有网络。<br />
                  &lsquo;container:<name|id>&lsquo;: 重新使用其它容器的网络栈。<br />
                                 &lsquo;host&rsquo;: 在该容器内使用host网络堆栈。注意：host模式对宿主机上的本地文件系统给定了容器全部的访问权限，包括D-bus，因此容器被认为是不安全的。</p>

<p>-P, &ndash;publish-all=false    发布所有的暴露端口到宿主机接口上。<br />
  -p, &ndash;publish=[]           发布容器的一个端口到宿主机接口上。<br />
                             格式：<br />
ip:hostPort:containerPort<br />
ip::containerPort<br />
hostPort:containerPort<br />
containerPort<br />
                               (使用 &lsquo;docker port&rsquo;查看实际的映射)<br />
  &ndash;privileged=false         给这个容器扩展权限。<br />
  &ndash;restart=&ldquo;&rdquo;               当容器退出时重启策略将会被应用，选项值有：<br />
(no, on-failure[:max-retry], always)<br />
  &ndash;security-opt=[]          安全选项。<br />
  -t, &ndash;tty=false            分配伪终端。<br />
  -u, &ndash;user=&ldquo;&rdquo;              用户名或者UID。<br />
  -v, &ndash;volume=[]             绑定挂载卷(例如，从宿主机挂接：-v /host:/container，从Docker挂接：-v /container)<br />
  &ndash;volumes-from=[]          从指定的容器挂载卷。<br />
  -w, &ndash;workdir=&ldquo;&rdquo;           指定容器内的工作目录。</p>

<p>docker diff</p>

<p>使用方法: docker diff CONTAINER</p>

<p>查看容器内文件系统的变化。</p>

<p>docker events</p>

<p>使用方法: docker events [OPTIONS]</p>

<p>从服务器上获得实时事件。<br />
  &ndash;since=&ldquo;&rdquo;         从指定的时间戳后显示所有事件。<br />
  &ndash;until=&ldquo;&rdquo;         流水时间显示到指定的时间为止。</p>

<p>docker exec</p>

<p>使用方法: docker exec [OPTIONS] CONTAINER COMMAND [ARG&hellip;]</p>

<p>在已经存在的容器内运行一个命令。</p>

<p>-d, &ndash;detach=false         分离模式: 在后台运行<br />
  -i, &ndash;interactive=false    即使没有附加也保持STDIN 打开<br />
  -t, &ndash;tty=false            分配一个伪终端</p>

<p>docker export</p>

<p>使用方法: docker export CONTAINER</p>

<p>将文件系统作为一个tar归档文件导出到STDOUT。</p>

<p>docker info</p>

<p>使用方法: docker info</p>

<p>显示系统级别的信息。</p>

<p>docker history</p>

<p>使用方法: docker history [OPTIONS] IMAGE</p>

<p>显示镜像的历史。</p>

<p>&ndash;no-trunc=false     不要截断输出。<br />
  -q, &ndash;quiet=false    只显示数字ID。</p>

<p>docker images</p>

<p>使用方法: docker images [OPTIONS] [NAME]</p>

<p>列出镜像。</p>

<p>-a, &ndash;all=false      显示所有镜像(默认情况下过滤掉中间层镜像)。<br />
  -f, &ndash;filter=[]      提供过滤值 (例如. &lsquo;dangling=true&rsquo;)<br />
  &ndash;no-trunc=false     不要截断输出。<br />
  -q, &ndash;quiet=false    只显示数字ID。</p>

<p>docker import</p>

<p>使用方法: docker import URL|- [REPOSITORY[:TAG]]</p>

<p>创建一个空的文件系统镜像，并且将压缩包(.tar, .tar.gz, .tgz, .bzip, .tar.xz, .txz)内容输入到其中。</p>

<p>docker inspect</p>

<p>使用方法: docker inspect [OPTIONS] CONTAINER|IMAGE [CONTAINER|IMAGE&hellip;]</p>

<p>查看容器或者镜像的低级信息。</p>

<p>-f, &ndash;format=&ldquo;&rdquo;    使用给定的模板格式化输出。</p>

<p>docker kill</p>

<p>使用方法: docker kill [OPTIONS] CONTAINER [CONTAINER&hellip;]</p>

<p>使用SIGKILL杀掉指定的容器。</p>

<p>-s, &ndash;signal=&ldquo;KILL&rdquo;    向容器发送的信号。</p>

<p>docker load</p>

<p>使用方法: docker load [OPTIONS]</p>

<p>从STDIN上载入tar包作为镜像。</p>

<p>-i, &ndash;input=&ldquo;&rdquo;     从tar文件，而不是STDIN读取。</p>

<p>docker login</p>

<p>使用方法: docker login [OPTIONS] [SERVER]</p>

<p>注册或者登录到一个Docker服务器，如果没有指定服务器，那么<a href="https://index.docker.io/v1/将会作为默认值。" target="_blank">https://index.docker.io/v1/将会作为默认值。</a></p>

<p>-e, &ndash;email=&ldquo;&rdquo;       邮件<br />
  -p, &ndash;password=&ldquo;&rdquo;    密码<br />
  -u, &ndash;username=&ldquo;&rdquo;    用户名</p>

<p>docker logout</p>

<p>使用方法: docker logout [SERVER]</p>

<p>从一个Docker registry退出，如果没有指定服务器，那么<a href="https://index.docker.io/v1/将会作为默认值。" target="_blank">https://index.docker.io/v1/将会作为默认值。</a></p>

<p>docker logs</p>

<p>使用方法: docker logs [OPTIONS] CONTAINER</p>

<p>从容器获取日志。</p>

<p>-f, &ndash;follow=false        跟踪日志输出。<br />
  -t, &ndash;timestamps=false    显示时间戳。<br />
  &ndash;tail=&ldquo;all&rdquo;              输出日志尾部特定行(默认是所有)。<br />
docker port</p>

<p>使用方法: docker port CONTAINER [PRIVATE_PORT[/PROTO]]</p>

<p>列出指定的容器的端口映射，或者查找将PRIVATE_PORT NAT到面向公众的端口。</p>

<p>docker pause<br />
使用方法: docker pause CONTAINER</p>

<p>暂停容器内所有的进程。</p>

<p>docker ps</p>

<p>使用方法: docker ps [OPTIONS]</p>

<p>列出容器。</p>

<p>-a, &ndash;all=false       显示所有的容器。默认情况下仅显示正在运行的容器。<br />
  &ndash;before=&ldquo;&rdquo;           仅显示在ID或者名字之前的容器，包括没有运行的容器。<br />
  -f, &ndash;filter=[]       提供过滤值. 有效的过滤器:<br />
                          exited=<int> - 容器退出的代码 <int><br />
                          status=(restarting|running|paused|exited)<br />
  -l, &ndash;latest=false    仅显示最后一个创建的容器，包括没有运行的。<br />
  -n=-1                 显示n个最后创建的容器，包括没有运行的。<br />
  &ndash;no-trunc=false      不要截断输出。<br />
  -q, &ndash;quiet=false     仅显示数值ID。<br />
  -s, &ndash;size=false      显示大小。<br />
  &ndash;since=&ldquo;&rdquo;            仅显示从Id 或者 Name以来的容器，包括没有运行的。</p>

<p>docker pull</p>

<p>使用方法: docker pull [OPTIONS] NAME[:TAG]</p>

<p>从registry上拉回一个镜像或者一个容器。</p>

<p>-a, &ndash;all-tags=false    在指定的仓库下载所有标记的镜像。</p>

<p>docker push</p>

<p>使用方法: docker push NAME[:TAG]</p>

<p>将一个镜像或者仓库推送到指定的仓库。</p>

<p>docker restart</p>

<p>使用方法: docker restart [OPTIONS] CONTAINER [CONTAINER&hellip;]</p>

<p>重新启动一个运行中的容器。</p>

<p>-t, &ndash;time=10      在杀掉指定容器之前停动的时间，一旦杀掉容器，那么就会重新启动。默认时间为10秒。</p>

<p>docker rm</p>

<p>使用方法: docker rm [OPTIONS] CONTAINER [CONTAINER&hellip;]</p>

<p>删除一个或者多个容器。</p>

<p>-f, &ndash;force=false      强制移除一个正在运行的容器(使用 SIGKILL)<br />
  -l, &ndash;link=false       移除指定的连接，而不是潜在的容器。<br />
  -v, &ndash;volumes=false    移除与容器相关的卷。</p>

<p>docker rmi</p>

<p>使用方法: docker rmi [OPTIONS] IMAGE [IMAGE&hellip;]</p>

<p>移除一个或者多个镜像。</p>

<p>-f, &ndash;force=false    强制移除一个镜像。<br />
  &ndash;no-prune=false     不要删除未标记的父镜像。</p>

<p>docker run</p>

<p>使用方法: docker run [OPTIONS] IMAGE [COMMAND] [ARG&hellip;]</p>

<p>在新的容器中运行一个命令。</p>

<p>-a, &ndash;attach=[]            附加到STDIN, STDOUT 或者 STDERR。<br />
  &ndash;add-host=[]              添加一个自定义的host-to-IP 映射(host:ip)。<br />
  -c, &ndash;cpu-shares=0         CPU shares (相对权重)。<br />
  &ndash;cap-add=[]               添加Linux capabilities。<br />
  &ndash;cap-drop=[]              放弃 Linux capabilities。<br />
  &ndash;cidfile=&ldquo;&rdquo;               将容器 ID写入文件。<br />
  &ndash;cpuset=&ldquo;&rdquo;                允许使用的CPU数量(0-3, 0,1)<br />
  -d, &ndash;detach=false         分离模式：在后台运行容器，并且显示出新容器的ID。<br />
  &ndash;device=[]                向容器添加一个宿主机设备。<br />
(例如， &ndash;device=/dev/sdc:/dev/xvdc)<br />
  &ndash;dns=[]                   设置自定义的DNS 服务器。<br />
  &ndash;dns-search=[]            设置自定义DNS 搜索域。<br />
  -e, &ndash;env=[]               设置环境变量。<br />
  &ndash;entrypoint=&ldquo;&rdquo;            覆盖掉镜像中默认的ENTRYPOINT。<br />
  &ndash;env-file=[]              读以逗号分隔的环境变量文件(文件中的行以逗号分隔，每一行都是环境变量)。<br />
  &ndash;expose=[]                将一个没有发布的端口暴露给宿主机。<br />
  -h, &ndash;hostname=&ldquo;&rdquo;          容器主机名字。<br />
  -i, &ndash;interactive=false    保持 STDIN 打开，即使没有被附加。<br />
  &ndash;link=[]                  以name:alias格式添加连接到其它容器上。<br />
  &ndash;lxc-conf=[]              (lxc exec-driver only) 添加自定义lxc 选项<br />
&ndash;lxc-conf=&ldquo;lxc.cgroup.cpuset.cpus = 0,1&rdquo;<br />
  -m, &ndash;memory=&ldquo;&rdquo;            内存限制 (格式: <number><optional unit>,<br />
unit = b, k, m or g)<br />
  &ndash;name=&ldquo;&rdquo;                  指定容器的名字。<br />
  &ndash;net=&ldquo;bridge&rdquo;             为容器设置网络模式，<br />
                               &lsquo;bridge&rsquo;: 在docker bridge桥上创建一个新的网络栈。<br />
                                 &lsquo;none&rsquo;: 该容器没有网络。<br />
                  &lsquo;container:<name|id>&lsquo;: 重新使用其它容器的网络栈。<br />
                                 &lsquo;host&rsquo;: 在该容器内使用host网络堆栈。注意：host模式对宿主机上的本地文件系统给定了容器全部的访问权限，包括D-bus，因此容器被认为是不安全的。</p>

<p>-P, &ndash;publish-all=false    发布所有的暴露端口到宿主机接口上。<br />
  -p, &ndash;publish=[]           发布容器的一个端口到宿主机接口上。<br />
                             格式：<br />
ip:hostPort:containerPort<br />
ip::containerPort<br />
hostPort:containerPort<br />
containerPort<br />
                               (使用 &lsquo;docker port&rsquo;查看实际的映射)<br />
  &ndash;privileged=false         给这个容器扩展权限。<br />
  &ndash;restart=&ldquo;&rdquo;               当容器退出时重启策略将会被应用，选项值有：<br />
(no, on-failure[:max-retry], always)<br />
  &ndash;security-opt=[]          安全选项。<br />
  -t, &ndash;tty=false            分配伪终端。<br />
  -u, &ndash;user=&ldquo;&rdquo;              用户名或者UID。<br />
  -v, &ndash;volume=[]             绑定挂载卷(例如，从宿主机挂接：-v /host:/container，从Docker挂接：-v /container)<br />
  &ndash;volumes-from=[]          从指定的容器挂载卷。<br />
  -w, &ndash;workdir=&ldquo;&rdquo;           指定容器内的工作目录。</p>

<p>docker save</p>

<p>使用方法: docker save [OPTIONS] IMAGE [IMAGE&hellip;]</p>

<p>将镜像保存到一个归档文件(默认为STDOUT)</p>

<p>-o, &ndash;output=&ldquo;&rdquo;    输出到一个文件而不是STDOUT。</p>

<p>docker search</p>

<p>使用方法: docker search [OPTIONS] TERM</p>

<p>从Docker Hub 上搜索镜像。</p>

<p>&ndash;automated=false    仅显示自动构建。<br />
  &ndash;no-trunc=false     不要截断输出。<br />
  -s, &ndash;stars=0        仅显示至少x 星级的镜像。</p>

<p>docker start</p>

<p>使用方法: docker start [OPTIONS] CONTAINER [CONTAINER&hellip;]</p>

<p>重新启动一个停止的容器。</p>

<p>-a, &ndash;attach=false         附加容器的STDOUT 和 STDERR，并且所有的信号到进程。<br />
  -i, &ndash;interactive=false    附加容器的STDIN。</p>

<p>docker stop</p>

<p>使用方法: docker stop [OPTIONS] CONTAINER [CONTAINER&hellip;]</p>

<p>通过发送SIGTERM 信号，在一个优雅的时间断后然后是SIGKILL停止运行的容器。</p>

<p>-t, &ndash;time=10      在杀掉容器之前等待容器停止的时间数。</p>

<p>docker tag</p>

<p>使用方法: docker tag [OPTIONS] IMAGE[:TAG] [REGISTRYHOST/][USERNAME/]NAME[:TAG]</p>

<p>标记一个进入仓库的镜像。</p>

<p>-f, &ndash;force=false    强制。</p>

<p>docker top</p>

<p>使用方法: docker top CONTAINER [ps OPTIONS]</p>

<p>显示容器中运行的进程。</p>

<p>docker unpause<br />
使用方法: docker unpause CONTAINER</p>

<p>取消暂停容器内的所有进程。</p>

<p>docker version</p>

<p>使用方法: docker version</p>

<p>显示Docker的版本信息。</p>

<p>docker wait</p>

<p>使用方法: docker wait CONTAINER [CONTAINER&hellip;]</p>

<p>Block until a container stops, then print its exit code.<br />
阻塞运行直到容器停止，然后打印出它的退出代码。</p>

<p>##############################################################################<br />
docker 之所以这么牛逼, 一是在于他强大的生态环境, 以及,他container和writable layer 的新颖的概念.<br />
docker镜像的简单剖析</p>

<p>docker的images,我们可以理解为积木, 一层一层往上搭, 最后完成一个工程化的大项目.</p>

<p>在最初,docker实际上,只有一个静态的image(Ps: read-only). 相当于只能读, 所以, 你所有的改动并不会影响到原来的image上, 只会一层一层的叠加, 比如, 你在Ubuntu的image上面, 再接一层nodeJS的image. 实际上的结果是, 两个image叠加起来.</p>

<p>这里放一张 the Docker book 的说明图:</p>

<p>(Ps: 算啦,估计大家也没听懂,还是在下面根据实例,来进行细致的区分吧)</p>

<p>docker 在下载image的时候,会在 /var/lib/docker 目录下创建相关的image 目录. 而运行的container则会放在 /var/lib/docker/containers 中.</p>

<p>另外,docker中的image,是存储在 docker仓库 . 现在,我们通过快速创建自已的仓库来仔细了解一下docker是怎样拥有这样一个完善的生态的.<br />
docker 仓库</p>

<p>首先, 要想拥有自己的docker 仓库, 你得有一个自己的docker账号.so, 那就想apply 一个呗. 在 docker hub 上面注册一下自己的账号就行.<br />
登录指令</p>

<p>在docker中,不仅支持web查看docker中的内容, 而且还支持使用命令行登录.</p>

<p>// 登录到docker<br />
docker login // 然后输入账户密码就ok了<br />
// 使用完毕,想要登出<br />
docker logout</p>

<p>实际上,docker会将你的认证信息存放在. ~/.docker/config.json 当中。<br />
images 常用命令</p>

<p>如果浏览了上面的docker仓库, 会发现在一个repository里面会存在很多images, 比如 ubuntu的repository .不同的images发布,代表的都是特定的版本系统. 所以,在拉取的时候,需要额外注意一下你需要的指定docker images.<br />
images的拉取</p>

<p>在container中,我们讲过,使用docker run的时候, 你会发现如果你的images里面没有存在指定的image时, docker会主动去docker hub里面找,然后下载,并且自动运行.</p>

<p>// 运行最新版的ubuntu image<br />
docker run -t -i ubuntu:latest</p>

<p>如果,你想自己手动下载images的话,可以直接 pull</p>

<p>// 手动拉取images<br />
docker pull ubuntu:latest<br />
// 拉取12.04版本的ubuntu images<br />
docker pull ubuntu:12.04</p>

<p>如果在拉取的时候,想知道这个image是否是真正存在的话,就可以使用.docker 提供的搜索指令.<br />
搜索指定docker</p>

<p>在docker中,可以使用自带的 search 命令,搜索所有含有指定term的image. 相当于js中的search 方法.</p>

<p>// 搜索name中含有demo的image<br />
docker search demo<br />
// 结果为: 名字. 通常为: author/image_name . 通常搜索的就是这个<br />
// 描述: 就是一段文字描述<br />
NAME  DESCRIPTION  STARS OFFICIAL   AUTOMATED</p>

<p>查到之后,我们就可以使用pull将指定的库,拉下来了.<br />
创建自己的image</p>

<p>上面说过, contianer是copy image运行的进程容器,image是不会变的read-only 块. 但是,如果我们在container里面, 改动了一些设置,比如,下载了node, 而且,我想要保存我这次改动, 以至于,下次我想重新,启动该image时, 他已经具备了node.</p>

<p>// 现在我再ubuntu:latest上面安装了node<br />
// 伪代码<br />
npm install node -g</p>

<p>docker提供了一个非常快捷的方式就是创建自己的docker image. 使用 docker commit .</p>

<p>// 查看刚才改动的container ID<br />
docker ps -a -q -l<br />
// 得到 docker_id, 提交到自己的库中<br />
docker commit docker_id villainHR/node<br />
// 之后会返回新的image id</p>

<p>需要注意, docker commit 提交的并不是一个整体的100+MB的ubuntu+node. 他只会将两个仓库的差异提交,比如原来image和新的image比起来,就是多了一个 npm install node -g 命令.<br />
使用Dockerfile</p>

<p>Dockerfile是为了迅速的构建image而出现的. 他与docker commit 的区别在于. 能够迅速的更替历史image 命令. 比如,我们以前下载的npm是version 2, 现在想要更换为npm@3的话,则难度就不是一般的了. 但是,如果我们能够像写命令一样将下载的配置命令下载Dockerfile里面, 那么以后我们想要更换版本,就是很方便的啦.</p>

<p>ok, 现在我们来了解一下Dockerfile是怎样的运行的.<br />
dockerfile demo讲解</p>

<p>这里,我们利用dockerfile 来搭建一个简单的webServer. 首先创建一个你自己的dockerfile目录</p>

<p>mkdir first_docker<br />
cd first_docker<br />
touch Dockerfile</p>

<p>然后, 确保你有ubuntu:latest image.因为, 接下来我们就是基于它,来搭建我们的server.</p>

<h1 id="first-dockerfile-demo">first dockerfile demo</h1>

<p>FROM ubuntu:latest</p>

<h1 id="设置该dockerfile的作者和联系邮箱">设置该dockerfile的作者和联系邮箱</h1>

<p>MAINTAINER Jimmy &ldquo;villainhr@gmail.com&rdquo;</p>

<h1 id="开始配置环境-下载apt-get-生成index-html的文件">开始配置环境, 下载apt-get,生成index.html的文件</h1>

<p>RUN apt-get update &amp;&amp; apt-get install -y nginx<br />
RUN echo &lsquo;first demo&rsquo; &gt; /usr/share/nginx/html/index.html</p>

<h1 id="暴露server的port">暴露server的port</h1>

<p>EXPOSE 80</p>

<p>说一下上面的命令内涵.</p>

<pre><code>FROM: 用来指定第一层image, 这是必须有的. 并且指定的image是存在在你的computer中. 相当于是 docker run.  

RUN: 这是用来在container中,做出相应的修改. 相当于 修改+docker commit xxx . 给原来的image加上一层layer. 然后, docker会在你commit新一层之后,重新docker run你最新改动过的image  

MAINTAINER: 设置作者和联系邮箱.其实就是docker commit 后面的Name参数. 而且加上了联系邮箱. 这是在dockerfile 运行完后,会自动添加到image上的.  

EXPOSE: 用来给最新的container 设置与外部交流的port  
</code></pre>

<p>上面简单的介绍了基本的dockerfile的命令. 不过, 这尼玛太简单了,不符合我们一贯追求到底的风格.</p>

<p>这里, 我们在来细说一下RUN这个命令. 实际上, 这应该是dockerfile的关键. RUN的原理很简单, 就是 commit + run . 先创建一个新的image 然后 在这个基础上将原有的container替换为新的,如果某一步的RUN发生错误,则container会停在那个阶段, 这样,你可以直接进入该container去查看,你那一步的RUN发生了什么BUG。 另外, 使用RUN的时候, 需要注意, 由于,dockerfile是由上到下解析的, 比如你一开始 FROM ubuntu 的image, 那么此时的环境是停留在ubuntu的shell中的.</p>

<p>比如:</p>

<p>RUN touch demo.js<br />
// 等同于<br />
/bin/sh -c touch demo.js</p>

<p>所以, 如果你调用的image 并没有shell的话, 那么久需要使用exec调用系统shell 来执行命令.</p>

<p>// 调用系统的shell来运行, 实际上就是 exec xxx xxx xxx.<br />
RUN [&ldquo;npm&rdquo;,&ldquo;install&rdquo;,&ldquo;node&rdquo;]</p>

<p>运行dockerfile</p>

<p>上面的dockerfile文件配置好了之后,就轮到我们运行dockerfile.直接运行 docker build 即可.</p>

<p>// 注意后面的&rdquo;.&ldquo;, 用来指定搜索dockerfile文件的路径.<br />
docker build -t=&ldquo;jimmy/first_dockerfile&rdquo; .</p>

<p>说一下docker build的指令吧.</p>

<p>// 基本格式为:<br />
docker build -t=&ldquo;repository/name:tag&rdquo;  directory<br />
// -t用来指定生成的image的name,比如仓库,image的名字以及他的tag,如果你不指定tag, 那么docker会自动添加latest代替。<br />
// directory 用来相对于当前运行build的目录, 搜索指定的dockerfile.当然,你也可以使用绝对路径了</p>

<p>顺利的话,应该就会有, 下列的信息出来.</p>

<p>Sending build context to Docker daemon 2.048 kB<br />
Step 1 : FROM ubuntu:latest<br />
 &mdash;&gt; c5f1cf30c96b<br />
Step 2 : MAINTAINER jimmy &ldquo;villainhr@gmai.com&rdquo;<br />
 &mdash;&gt; Running in 078148a5086a<br />
 &mdash;&gt; 11b061f665d1<br />
Removing intermediate container 078148a5086a<br />
Step 3 : RUN cd /var<br />
 &mdash;&gt; Running in ffd3141e64c8<br />
 &mdash;&gt; a4d7c5303b60<br />
Removing intermediate container ffd3141e64c8<br />
Step 4 : RUN touch demo.js<br />
 &mdash;&gt; Running in c8393a6fcc98<br />
 &mdash;&gt; 109b402b9adc<br />
Removing intermediate container c8393a6fcc98<br />
Step 5 : EXPOSE 80<br />
 &mdash;&gt; Running in 2c064f4bac57<br />
 &mdash;&gt; ff7ad58a5d8a<br />
Removing intermediate container 2c064f4bac57<br />
Successfully built ff7ad58a5d8a</p>

<p>然后, 你可以使用 docker images 查看.就会发现多出来一个image.<br />
dockerfile cache</p>

<p>上面已经提到过,使用docker build的时候,如果你的dockerfile中的某一步出现问题的话,你生成的image会停留在那一步.当你fix errors时, 重新运行 docker build , 此时,docker是不会真的重头来建一遍的,他会使用你改动line的前一个image,然后以此为基点继续向下构建.</p>

<p>不过,如果你使用缓存的话,他前面的版本id是不会发生改变的.如果你想完整的得到一个新的ID的话,就可以在build的时候,禁用掉cache.</p>

<p>docker build &ndash;no-cache -t=&ldquo;jimmy/first_dockerfile&rdquo; .</p>

<p>不过,该方法是不推荐的. 因为一个非常棒的cache机制,就被你硬生生的cancel. 而且,这也极力不推荐使用该方法进行cache的取消.以为,有些地方,我们完全可以利用cache来加快速度.这就需要使用到 ENV 关键字.来帮助我们,另外利用cache.</p>

<p>在讲解 ENV 之前,先给大家讲解一下docker cache的运行机理.</p>

<p>（是不是感觉很激动~）</p>

<p>实际上,机理就一句话: ID命中 . 因为docker在你每次运行一行命令的时候,会自动生成一个id值.</p>

<p>Sending build context to Docker daemon 2.048 kB<br />
Step 1 : FROM ubuntu:latest<br />
 &mdash;&gt; c5f1cf30c96b  // 这就是ID值</p>

<p>docker借由这个ID值,来判断是否有cache镜像.所以,这里就需要借一下 ENV 这个比较费的指令,来灵活的帮助我们使用cache.<br />
配置化cache</p>

<p>ENV 的就是给docker来设置变量的. 基本格式为:</p>

<h1 id="一个一个的赋值">一个一个的赋值</h1>

<p>ENV key value<br />
// demo:<br />
ENV name jimmy<br />
ENV age 18</p>

<h1 id="另外-还可以一起赋值">另外,还可以一起赋值</h1>

<p>ENV key=value[&hellip;]<br />
// demo:<br />
ENV name=jimmy age=18</p>

<p>而通过 ENV 我们就可以完美的告诉docker 从这里开始,你就不能使用cache,自己的重新来.( 因为,每条指令都会生成layer并且有独立的id,一旦你更改的ENV,那么从该指令开始id都会发生改变,也就匹配不到缓存了 )</p>

<p>看个demo:</p>

<h1 id="第一个dockerfile">第一个dockerfile</h1>

<p>FROM ubuntu:latest<br />
MAINTAINER jimmy &ldquo;villainhr@gmai.com&rdquo;<br />
ENV REFRESH first # 这里设置的是refresh=first<br />
RUN cd /var<br />
RUN touch demo.js<br />
EXPOSE 80</p>

<p>// 使用docker build &hellip; 后面就会生成一系列新的id和images<br />
// 现在修改dockerfile</p>

<h1 id="第二个dockerfile">第二个dockerfile</h1>

<p>FROM ubuntu:latest<br />
MAINTAINER jimmy &ldquo;villainhr@gmai.com&rdquo;<br />
ENV REFRESH second # 这里设置的是refresh=second<br />
RUN cd /var<br />
RUN touch demo.js<br />
EXPOSE 80</p>

<p>// 开始运行docker build&hellip; 你会发现,从下面语句开始.<br />
ENV REFRESH second<br />
// 其docker id就已经发生了改变,并且docker 没有了use cache的提示.说明,下面就没有命中缓存了. 所以,如果你想在某一段不使用缓存,只需要将ENV后面的value改变即可.</p>

<p>创建完后, 我们可以使用 docker history ,查看一下刚才创建的image的整个流程.</p>

<p>// 查看image创建的过程<br />
docker history jimmy/first_dockerfile<br />
// 输出的结果为:<br />
2322ddc85cc3        10 hours ago        /bin/sh -c #(nop) EXPOSE 80/tcp                 0 B<br />
b39397abc7aa        10 hours ago        /bin/sh -c touch demo.js                        0 B<br />
3c9a4daf4c42        10 hours ago        /bin/sh -c cd /var                              0 B<br />
b1c2f890a262        10 hours ago        /bin/sh -c #(nop) ENV REFRESH=second            0 B<br />
2cf0ee3c373c        10 hours ago        /bin/sh -c #(nop) MAINTAINER jimmy &ldquo;villainhr   0 B</p>

<p>俺的目的,其实是想让你们看看,docker在每一层是怎么执行的&ndash; /bin/sh . 了解了之后,我们就继续了.<br />
docker container的接口暴露</p>

<p>上面通过dockerfile 已经暴露了一个80接口,用来和外部通信。 不过,如果我们没有使用 EXPOSE 暴露接口的话, 那应该怎么做呢？</p>

<p>我们可以直接在外部运行docker image, 手动指定暴露的端口.</p>

<h1 id="同样-暴露80端口给外部交互">同样,暴露80端口给外部交互</h1>

<p>docker run -d -p 80 &ndash;name demo jimmy/node \<br />
node -jimmy app.js</p>

<h1 id="d是daemon的意思">-d是daemon的意思</h1>

<h1 id="p-80-表示暴露80的port给外部">-p 80 表示暴露80的port给外部</h1>

<h1 id="node-jimmy-app-js-表示在jimmy-node-image里面运行的指令">node -jimmy app.js 表示在jimmy/node image里面运行的指令</h1>

<p>这里, 我们需要额外了解一下80端口的开启. docker 其实是在底层上面,虚拟化了存储. 并且,docker在运行的时候,会自动向主机要一个ip(假的), 相当于,有了自己的host. (这不就一个主机吗？)</p>

<p>这里我们开启的80端口,是docker在内部虚拟开启的, 他会从32768 到 61000端口之间,随机抽一个映射到docker开启的80端口上, 依此来和外部进行真正的交互(膜拜///).</p>

<h1 id="使用docker-ps-l-来查看开启情况">使用docker ps -l 来查看开启情况</h1>

<p>docker ps -l</p>

<h1 id="得到-只截取了一部分">得到: 只截取了一部分.</h1>

<p>0.0.0.0:49154-&gt;80 tcp</p>

<h1 id="或者指定查看docker端口开启情况">或者指定查看docker端口开启情况</h1>

<p>docker port c96f2c18bb64 80 // ID也可以使用name代替</p>

<h1 id="返回">返回:</h1>

<p>0.0.0.0:49154</p>

<p>手动指定端口</p>

<p>如果你不想让docker决定的绑定的接口是哪一个,ok, 你可以自己指定.</p>

<h1 id="手动指定端口">手动指定端口</h1>

<h1 id="指定docker的8080连接到container暴露的80端口">指定docker的8080连接到container暴露的80端口</h1>

<p>docker run -d -p 8080:80 &ndash;name demo jimmy/node \<br />
node -jimmy app.js</p>

<h1 id="甚至你也可以指定ip-port">甚至你也可以指定ip+port</h1>

<h1 id="指定docker的127-0-0-1-8080连接container的80">指定docker的127.0.0.1:8080连接container的80</h1>

<p>docker run -d -p 127.0.0.1:8080:80 &ndash;name demo jimmy/node \<br />
node -jimmy app.js</p>

<p>利用EXPOSE</p>

<p>在写dockerfile的时候,我们已经了解了,使用EXPOSE可以完美的实现端口的暴露. 但如果,我们在dockerfile里面暴露多个port的话,那么-p的参数,感觉有点鸡肋啊喂~</p>

<p>不过,现在我们可以使用 -P (注意是大写). 来手动开启所有在dockerfile中,通过 EXPOSE 暴露的端口.</p>

<p>docker run -d -P &ndash;name demo jimmy/node \<br />
node -jimmy app.js</p>

<p>外部访问</p>

<p>通过端口开启之后,我们就可以间接的访问docker的路由, 来访问在docker里面开启的端口了.</p>

<h1 id="假如上面我们通过dockre暴露的端口是34251的话-就可以在docker环境外访问了">假如上面我们通过dockre暴露的端口是34251的话,就可以在docker环境外访问了.</h1>

<p>ping localhost:34251</p>

<p>dockerfile常用指令<br />
自动化运行CMD</p>

<p>你是不是已经厌烦了使用docker run 来运行命令了呢？ 你是不是已经讨厌重复的copy命令运行了呢？</p>

<p>那么请使用 CMD 吧.</p>

<p>CMD的作用是,用来指定当你调其对应的container时, 运行的命令.</p>

<p>比如在dockerfile中,指定/bin/bash.</p>

<h1 id="当调起container时-运行-bin-bash">当调起container时,运行/bin/bash</h1>

<p>docker run  -t -i jimmy/ubuntu:latest /bin/bash</p>

<h1 id="等同于在dockerfile中指定cmd">等同于在dockerfile中指定CMD</h1>

<p>CMD [&ldquo;/bin/bash&rdquo;]<br />
// 运行docker run<br />
docker run -t -i jimmy/ubuntu:latest</p>

<p>不过,如果你在run后面手动指定指令运行的话,会默认覆盖掉CMD提供的命令.</p>

<p>熟悉了CMD,感觉有种 RUN 的感觉. 但,这两者的区别还是很大的</p>

<pre><code>RUN: 一般是用来给image增加layer来完善image, 他一旦执行完,就和后面的运行没有关系了  

CMD: 这个在docker build过程中,是没有半毛钱关系的. 他只和在调用image时,关系比较大  
</code></pre>

<p>强制运行ENTRYPOINT</p>

<p>这里的 ENTRYPOINT 和 CMD 很相似. 可以说,在一定程度上两者可以互相替代,但,两者的实际意义相差还是挺大的.</p>

<p>ENTRYPOINT 的主要功能是强制执行的环境.</p>

<h1 id="指定entrypoint为-bin-sh">指定ENTRYPOINT为/bin/sh</h1>

<p>ENTRYPOINT [&ldquo;/bin/sh&rdquo;]<br />
// 然后在build之后,调起container</p>

<h1 id="我们尝试在run后面加上参数">我们尝试在run后面加上参数:</h1>

<p>docker run -t -i jimmy/demo /bin/bash/<br />
// 不出意外的话,会得到一个bug提示:<br />
&gt;&gt; /bin/sh: 0: Can&rsquo;t open /bin/bash/</p>

<p>所以, ENTRYPOINT 的主要功能实际上是,指定了内部运行命令的解析器. 而使用docker run添加的命令,会被当做参数添加给 ENTRYPOINT .</p>

<h1 id="已经指定了entrypoint-bin-sh">已经指定了ENTRYPOINT [&ldquo;/bin/sh&rdquo;]</h1>

<h1 id="运行docker-run">运行docker run</h1>

<p>docker run -t -i jimmy/demo /bin/bash/</p>

<h1 id="实际上相当于-不出错才怪嘞">实际上相当于(不出错才怪嘞&hellip;)</h1>

<p>/bin/sh /bin/bash/</p>

<p>另外,我们还可以使用 CMD 配合 ENTRYPOINT 写成默认参数的效果.</p>

<h1 id="默认执行-bin-bash-default-sh">默认执行 /bin/bash default.sh</h1>

<p>ENTRYPOINT [&ldquo;/bin/bash&rdquo;]<br />
CMD [&ldquo;default.sh&rdquo;]</p>

<h1 id="如果你在docker-run中指定了参数的话-则cmd会默认被代替">如果你在docker run中指定了参数的话,则CMD会默认被代替</h1>

<p>docker run jimmy/demo sam.sh</p>

<p>不过,CMD和ENTRYPOINT都只能在dockerfile里面出现一次.<br />
指定运行目录WORKDIR</p>

<p>既然,我们能够在dockerfile里面运行指定的命令。 但,有时,我们仅仅是想在不同的目录中执行不同的命令. 那,在dockerfile中,如何做到灵活的目录切换呢？</p>

<p>那就得使用docker提供的 WORKDIR 命令了.</p>

<h1 id="在-var-data里面创建data-js">在/var/data里面创建data.js</h1>

<p>WORKDIR /var/data<br />
RUN touch data.js</p>

<h1 id="然后在-etc-下创建data-conf文件">然后在/etc 下创建data.conf文件</h1>

<p>WORKDIR /etc<br />
RUN touch data.conf</p>

<p>并且当你在使用docker run时,他也会停留在使用 WORKDIR 指定的目录中.<br />
环境变量的设置ENV</p>

<p>ENV 在dockerfile里面的用处,应该算是灰常大的. 什么灵活更新,什么变量设置,什么更改全局变量等. 都是so easy.</p>

<p>那 ENV 到底是用来干嘛的?</p>

<p>答: 就是用来设置变量的啊喂. 只是他是设置全局变量.</p>

<p>比如像PATH神马的之类的.</p>

<h1 id="设置一个data的全局变量">设置一个DATA的全局变量.</h1>

<p>ENV DATA=jimmy</p>

<p>ENV最独特之处在于,他所设置的变量,会在你运行的时候生效.即,如果你修改了PATH,他也会在container中立即生效.</p>

<h1 id="修改环境变量-1">修改环境变量</h1>

<p>ENV PATH=$PATH:/user/bin<br />
// 现在进入到运行的container中<br />
echo $PATH<br />
&gt;&gt; /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/data</p>

<p>挂载通用盘VOLUME</p>

<p>在说里面正式的内容之前,我们先来说一下,什么叫做 VOLUME . 说人话吧, VOLUME 叫做数据卷, 相当于通用盘一样的东西. 他其实也是一个存储装置,我们就把他叫做硬盘吧. 这个硬盘不普通,有&gt;1的外接口.(说人话) 每一个外接口,都可以接入到一个操作系统里面. 即,实现了多个系统的数据共享.</p>

<p>一句话:</p>

<p>VOLUME就是一个数据共享盘</p>

<p>而,docker秉承着,虚拟储存idea, 想下面idea践行到底.</p>

<p>wirte once, run anywhere</p>

<p>(感觉,在哪见过)</p>

<p>所以, dockerfile提供了一个 VOLUME 的指令,能够让我们指定数据卷的位置.</p>

<h1 id="指定-opt-data为数据卷">指定/opt/data为数据卷</h1>

<p>VOLUME [&ldquo;/opt/data&rdquo;]</p>

<h1 id="指定多个目录为数据卷-opt-data-opt-project">指定多个目录为数据卷/opt/data, /opt/project</h1>

<p>VOLUME [&ldquo;/opt/data&rdquo;,&ldquo;/opt/project&rdquo;]</p>

<p>当然,关于数据卷的操作,肯定不止挂载这一点,还有迁移,备份等等,相关操作. 具体,可以参考: Docker VOLUME<br />
添加外部文件ADD</p>

<p>有时,我们仅仅是想将外部文件copy到container中,docker有办法吗？</p>

<p>nonsense</p>

<p>docker 提供了 ADD 命令,来帮助我们完成文件的添加. 不过,这里ADD有点限制, 即, 你添加的文件或者目录,只能在docker build运行的目录下, 因为,这是docker在调起container的时候,只将该目录放进了daemon(尴尬~)</p>

<h1 id="现假设-docker-build运行的目录为-data">现假设,docker build运行的目录为: /data</h1>

<p>// 只能添加指定目录下<br />
// 将/data/sam.js 添加到image中的/opt/node/sam.js<br />
// 如果存在该文件,则不会被覆盖<br />
ADD sam.js /opt/node/</p>

<h1 id="添加文件-还可以使用通配符">添加文件,还可以使用通配符</h1>

<p>// 将所有的js文件,添加到node目录下<br />
ADD *.js /opt/node/</p>

<h1 id="如果destination不是绝对路径-则相对于最近的workdir">如果destination不是绝对路径,则相对于最近的WORKDIR</h1>

<p>// 如果最近的WORKDIR为/var<br />
// 则下列添加的路径为/var/opt/node<br />
ADD *.js opt/node/</p>

<p>当文件被添加到指定目录中时,该文件的权限是755,并且UID和GID都是0.</p>

<p>ADD 还支持url添加,以及文件自动解压.</p>

<h1 id="使用url添加">使用url添加</h1>

<p>// 将指定路由的文件放到根目录当中<br />
ADD <a href="http://example.com/foobar" target="_blank">http://example.com/foobar</a> /</p>

<h1 id="自动解压tar-gz文件">自动解压tar.gz文件</h1>

<p>// 将文件解压过后放在指定目录中<br />
ADD latest.tar.gz /var/www/wordpress/</p>

<p>纯粹的COPY</p>

<p>COPY和ADD非常类似. 我们可以做个类比:</p>

<p>ADD 包含 COPY</p>

<p>COPY做的事情比不上ADD, 他比ADD少了解压缩和URL下载的功能. 不过,他耗费的性能比较少,他只做纯粹的添加和下载.他的结构和ADD一毛一样. 不过, 有一点,COPY的时候,如果遇到目录不存在的情况下,COPY会自动创建</p>

<p>COPY file.js /opt/data/</p>

<p>添加个人信息LABEL</p>

<p>顾名思义,使用 LABEL 就是给你的image打上独一无二的标签.让别人能够了解,这个Image是属于你的. 又或是,用来提醒你自己,这个image现在处于哪一个版本状态.</p>

<h1 id="设置自己的label-1">设置自己的label</h1>

<p>LABEL owner=&ldquo;jimmy&rdquo; version=&ldquo;0.0.1&rdquo;</p>

<p>在创建完image之后, 我们可以使用 docker inspect 来查看我们已经打的LABEL</p>

<p>docker inspect jimmy/node<br />
&hellip;<br />
labels:{<br />
    owner:&ldquo;jimmy&rdquo;,<br />
    version:&ldquo;0.0.1&rdquo;<br />
}<br />
&hellip;</p>

<p>本人觉得, 这个指令其实真的,有时, 母鸡用到什么地方去&hellip;</p>

<p>并且,书写的时候,最好多个连着写,因为这样只会增加一层image.(image的层数是有限制的)<br />
参数形式ARG</p>

<p>这是docker提供的另外一个,让我有点懵逼的命令. 他的实际效果和 ENV 的区别可以趋近于无。</p>

<h1 id="使用arg定义变量">使用ARG定义变量</h1>

<p>ARG buildno</p>

<h1 id="设置默认值">设置默认值</h1>

<p>ARG user1=someuser</p>

<p>当然,我们可以在命令中,手动指定替换.</p>

<h1 id="在dockerfile定义了默认变量-1">在dockerfile定义了默认变量</h1>

<p>ARG user=jimy</p>

<h1 id="在运行时-进行手动替换-1">在运行时,进行手动替换</h1>

<p>docker build &ndash;build-arg user=sam -t jimmy/demo .</p>

<p>上面说了ARG和ENV比较类似,不过,里面的区别还是有的. 即, ARG只能用在 docker build 的阶段, 并且不会被保存在 image 中,这就是和ENV的区别.<br />
模板image之ONBUILD</p>

<p>因为dockerfile的构建的层数有限制,所以,这也带给了我们一些麻烦, 如果搭建的环境过多,则会造成写到一半,发现dockerfile已经full. 这时候, 就轮到ONBUILD出场了. ONBUILD 的作用在于,他可以完美的实现模板image的搭建.</p>

<p>ONBUILD的主要作用在于,他定义的命令,可以在子dockerfile中使用.(md&hellip; 好绕口)</p>

<h1 id="使用onbuild-默认下载apache">使用ONBUILD 默认下载Apache</h1>

<p>ONBUILD RUN apt-get update &amp;&amp; apt-get install -y apache2</p>

<p>// 然后运行docker file 会得到下列结果<br />
 Step 3 : ONBUILD RUN apt-get update &amp;&amp; apt-get install -y apache2<br />
   &mdash;&gt; Running in 0e117f6ea4ba<br />
   &mdash;&gt; a79983575b8</p>

<p>//然后生成一个新的image,我们这里暂且叫他jimmy/demo</p>

<p>接下来,我们再来写一个dockerfile</p>

<h1 id="这里继承上面的jimmy-demo">这里继承上面的jimmy/demo</h1>

<p>FROM jimmy/demo:latest<br />
ENV SEX=001</p>

<p>// 运行上面的dockerfile,得到:<br />
Step 0 : FROM jimmy/demo</p>

<h1 id="executing-1-build-triggers">Executing 1 build triggers</h1>

<p>Step onbuild-0 : ADD . /var/www/<br />
   &mdash;&gt; 1a018213a59d<br />
   &mdash;&gt; 1a018213a59d<br />
 Step 1: ENV SEX=001<br />
 &hellip;</p>

<p>细心的童鞋可以发现这一条命令:</p>

<p>Step onbuild-0 : RUN apt-get update &amp;&amp; apt-get install -y apache2<br />
   &mdash;&gt; 1a018213a59d<br />
   &mdash;&gt; 1a018213a59d</p>

<p>他居然在这里自动运行了. 所以,我们可以将 ONBUILD 命令理解为模板命令. 即,子dockerfile里面运行时同样生效(这里,我没有说grandchildren的事).</p>

<p>但 ONBUILD 只能往下延伸一级. 相当于你用 ONBUILD 定义的命令,有两次有效次数,一次在build原来Image时,已经用掉了. 所以, 另外一次(在子dockerfile中使用)用掉了之后就无效了. grandchildren dockerfile就没法使用了.</p>

                      
                    </div>
                    <div style="border: 1px dashed #e0e0e0; padding: 10px 10px 10px 10px; background-color: #fffeee; background-repeat: no-repeat; background-attachment: scroll; background-position: 1% 50%; -moz-background-size: auto auto; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
    <div style="float:left;margin-top:0px;">
    <img src="http://blog.pytool.com/public/qrcode.jpg" width="129px" height="129px"/>
    <div style="text-align:center;">微信扫一扫交流</div>
    </div>
    <div>
        <p style="margin-top:0px;">作者：<a target="_blank" href="http://blog.pytool.com/">rinetd</a>
        
        <br />本文出处：<a target="_blank" href="http://blog.pytool.com/post/docker/2016-01-01-linux%E5%91%BD%E4%BB%A4-dockerfile/">http://blog.pytool.com/post/docker/2016-01-01-linux%E5%91%BD%E4%BB%A4-dockerfile/</a>
        <br />
        文章版权归本人所有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文连接，否则保留追究法律责任的权利。 </p>
    </div>
</div>

                    <div class="clear"></div>
                  </div>
                  

                </div>
                
              </article>
              
              <div class="clear"></div>
              

              
<section id="comments" class="themeform">
  <div id="SOHUCS"></div>
	<script type="text/javascript">
	(function(){
		if (window.location.hostname === 'localhost') return;
		if (window.location.hostname === '127.0.0.1') return;

		var appid = 'cytgPrsTW';
		var conf = 'prod_a8b514a0c64b034bba38e466be98c266';
		var width = window.innerWidth || document.documentElement.clientWidth;
		if (width < 960) {window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); }
	})();
	</script>

  

  



  


</section>

            </div>
          </section>
          <div class="sidebar s1">
  <a class="sidebar-toggle" title="Expand Sidebar"><i class="fa icon-sidebar-toggle"></i></a>
  <div class="sidebar-content">
    <div class="sidebar-top group">
      <p>Follow:</p>
      <ul class="social-links">
    <li>
    <a class="social-tooltip" title="On WeiBo"
        href="http://weibo.com/rinetd" target="_blank">
        <i class="fa fa-weibo"></i>
    </a>
    </li>
    <li>
    <a class="social-tooltip" title="On Twitter" rel="nofollow"
        href="https://twitter.com/rinetd" target="_blank">
        <i class="fa fa-twitter"></i>
    </a>
    </li>
    <li>
    <a class="social-tooltip" title="On GitHub"
        href="https://github.com/rinetd" target="_blank">
        <i class="fa fa-github"></i>
    </a>
    </li>
</ul>

    </div>

    <ul class="post-nav group">
    <li class="previous">
      
      <a href="http://blog.pytool.com/post/docker/2016-01-02-linux%E5%91%BD%E4%BB%A4-docker-volume/" rel="prev">
        <i class="fa fa-chevron-left"></i>
        <strong>Previous Post</strong>
        <span>Linux命令 Docker volume</span>
      </a>
      
  </li>
</ul>

    <div id="categories-2" class="widget widget_categories"><h3>分类</h3>
  <ul>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/android/">Android</a>
        <small>(17)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/android%E5%BA%95%E5%B1%82/">Android底层</a>
        <small>(7)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/english/">English</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/golang/">Golang</a>
        <small>(57)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/lessons/">Lessons</a>
        <small>(17)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/linux%E5%86%85%E6%A0%B8/">Linux内核</a>
        <small>(4)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/linux%E5%91%BD%E4%BB%A4/">Linux命令</a>
        <small>(93)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/linux%E5%9F%BA%E7%A1%80/">Linux基础</a>
        <small>(96)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/stm32/">Stm32</a>
        <small>(5)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/%E4%B8%AD%E5%8C%BB/">中医</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/">前端技术</a>
        <small>(3)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/%E5%A5%87%E7%9C%9F%E5%BC%82%E5%AE%9D/">奇真异宝</a>
        <small>(10)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/%E5%B5%8C%E5%85%A5%E5%BC%8Flinux/">嵌入式linux</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
        <small>(19)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/%E6%95%B0%E6%8D%AE%E7%AE%97%E6%B3%95/">数据算法</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91/">文本编辑</a>
        <small>(25)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a>
        <small>(2)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">正则表达式</a>
        <small>(3)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/%E7%A8%8B%E5%BA%8F%E5%91%98/">程序员</a>
        <small>(8)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/">端口转发</a>
        <small>(1)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a>
        <small>(44)</small>
      </li>
    
      <li class="cat-item cat-item-1">
        <a rel="nofollow" href="http://blog.pytool.com/categories/%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/">静态博客</a>
        <small>(11)</small>
      </li>
    
  </ul>
</div>

    
    
     
  <div id="search-2" class="widget widget_search"><h3>Search</h3>
      <form method="get" class="searchform themeform" action="https://www.google.com/search">
        <div>
          <input type="text" class="search" name="q" placeholder="Press enter to start searching">
        </div>
      </form>
    </div>
  </div>
  
</div>

          <div class="sidebar s2">
  <a class="sidebar-toggle" title="Expand Sidebar"><i class="fa icon-sidebar-toggle"></i></a>
  <div class="sidebar-content">
    <div class="sidebar-top group">
      <p>More</p>
    </div>

    
    <ul class="post-nav group">
    <li class="next">
      
      <a href="http://blog.pytool.com/post/docker/2016-01-02-linux%E5%91%BD%E4%BB%A4-alpine/" rel="next">
        <i class="fa fa-chevron-right"></i>
        <strong>Next post</strong>
        <span>Linux命令 alpie</span>
      </a>
      
  </li>
</ul>

    <div id="tag_cloud-2" class="widget widget_tag_cloud"><h3>标签云</h3>
  <div class="tagcloud post-tags">
      
         <a rel="tag" href="http://blog.pytool.com/tags/ack/" class="tag-link-8" title="1 Posts">ack<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/activity/" class="tag-link-3" title="1 Posts">activity<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/adb/" class="tag-link-8" title="1 Posts">adb<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/android/" class="tag-link-4" title="1 Posts">android<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/ansible/" class="tag-link-4" title="1 Posts">ansible<small>(3)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/apt/" class="tag-link-8" title="1 Posts">apt<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/aria2/" class="tag-link-6" title="1 Posts">aria2<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/arp/" class="tag-link-8" title="1 Posts">arp<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/atom/" class="tag-link-7" title="1 Posts">atom<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/autohotkey/" class="tag-link-1" title="1 Posts">autohotkey<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/awesome/" class="tag-link-4" title="1 Posts">awesome<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/awk/" class="tag-link-8" title="1 Posts">awk<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/bash/" class="tag-link-7" title="1 Posts">bash<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/bat/" class="tag-link-8" title="1 Posts">bat<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/bc/" class="tag-link-9" title="1 Posts">bc<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/bower/" class="tag-link-6" title="1 Posts">bower<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/burpssuite/" class="tag-link-1" title="1 Posts">burpssuite<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/burpsuite/" class="tag-link-2" title="1 Posts">burpsuite<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/capistrano/" class="tag-link-1" title="1 Posts">capistrano<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/cash/" class="tag-link-7" title="1 Posts">cash<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/centos7/" class="tag-link-4" title="1 Posts">centos7<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/coffeescript/" class="tag-link--1" title="1 Posts">coffeescript<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/composer/" class="tag-link-3" title="1 Posts">composer<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/coreos/" class="tag-link-5" title="1 Posts">coreos<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/crontab/" class="tag-link-4" title="1 Posts">crontab<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/cryptsetup/" class="tag-link-1" title="1 Posts">cryptsetup<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/css/" class="tag-link-8" title="1 Posts">css<small>(12)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/css3/" class="tag-link-7" title="1 Posts">css3<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/ctags/" class="tag-link-6" title="1 Posts">ctags<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/curl/" class="tag-link-7" title="1 Posts">curl<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/date/" class="tag-link-7" title="1 Posts">date<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/dd/" class="tag-link-9" title="1 Posts">dd<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/debug/" class="tag-link-6" title="1 Posts">debug<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/devops/" class="tag-link-5" title="1 Posts">devops<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/discourse/" class="tag-link-2" title="1 Posts">discourse<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/dnsmasq/" class="tag-link-4" title="1 Posts">dnsmasq<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/docker/" class="tag-link-5" title="1 Posts">docker<small>(8)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/dpkg/" class="tag-link-7" title="1 Posts">dpkg<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/editorconfig/" class="tag-link--1" title="1 Posts">editorconfig<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/emacs/" class="tag-link-6" title="1 Posts">emacs<small>(12)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/enca/" class="tag-link-7" title="1 Posts">enca<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/encode/" class="tag-link-5" title="1 Posts">encode<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/etcd/" class="tag-link-7" title="1 Posts">etcd<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/expect/" class="tag-link-5" title="1 Posts">expect<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/expr/" class="tag-link-7" title="1 Posts">expr<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/extundelete/" class="tag-link-0" title="1 Posts">extundelete<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/ffmpeg/" class="tag-link-5" title="1 Posts">ffmpeg<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/find/" class="tag-link-7" title="1 Posts">find<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/firewall/" class="tag-link-3" title="1 Posts">firewall<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/fonts/" class="tag-link-6" title="1 Posts">fonts<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/fstab/" class="tag-link-6" title="1 Posts">fstab<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/gdb/" class="tag-link-8" title="1 Posts">gdb<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/git/" class="tag-link-8" title="1 Posts">git<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/glang/" class="tag-link-6" title="1 Posts">glang<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/go/" class="tag-link-9" title="1 Posts">go<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/go-shadowsocks2/" class="tag-link--4" title="1 Posts">go-shadowsocks2<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/golang/" class="tag-link-5" title="1 Posts">golang<small>(57)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/gpg/" class="tag-link-8" title="1 Posts">gpg<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/gpio/" class="tag-link-7" title="1 Posts">gpio<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/grep/" class="tag-link-7" title="1 Posts">grep<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/hexdump/" class="tag-link-4" title="1 Posts">hexdump<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/hexo/" class="tag-link-7" title="1 Posts">hexo<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/hmac/" class="tag-link-7" title="1 Posts">hmac<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/html/" class="tag-link-7" title="1 Posts">html<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/html5/" class="tag-link-6" title="1 Posts">html5<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/http/" class="tag-link-7" title="1 Posts">http<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/httperf/" class="tag-link-4" title="1 Posts">httperf<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/hugo/" class="tag-link-7" title="1 Posts">hugo<small>(8)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/hydra/" class="tag-link-6" title="1 Posts">hydra<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/i18n/" class="tag-link-7" title="1 Posts">i18n<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/ifttt/" class="tag-link-6" title="1 Posts">ifttt<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/imagemagick/" class="tag-link-0" title="1 Posts">imagemagick<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/index/" class="tag-link-6" title="1 Posts">index<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/insomnia/" class="tag-link-3" title="1 Posts">insomnia<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/intent/" class="tag-link-5" title="1 Posts">intent<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/ios/" class="tag-link-8" title="1 Posts">ios<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/iotop/" class="tag-link-6" title="1 Posts">iotop<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/ip/" class="tag-link-9" title="1 Posts">ip<small>(10)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/iproute2/" class="tag-link-3" title="1 Posts">iproute2<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/iptables/" class="tag-link-3" title="1 Posts">iptables<small>(4)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/irc/" class="tag-link-8" title="1 Posts">irc<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/javascript/" class="tag-link-1" title="1 Posts">javascript<small>(6)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/join/" class="tag-link-7" title="1 Posts">join<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/js/" class="tag-link-9" title="1 Posts">js<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/key/" class="tag-link-8" title="1 Posts">key<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/linux/" class="tag-link-6" title="1 Posts">linux<small>(6)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/linux%E5%91%BD%E4%BB%A4/" class="tag-link-0" title="1 Posts">linux命令<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/locale/" class="tag-link-5" title="1 Posts">locale<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/losetup/" class="tag-link-4" title="1 Posts">losetup<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/lsof/" class="tag-link-7" title="1 Posts">lsof<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/lunr/" class="tag-link-7" title="1 Posts">lunr<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/lvm2/" class="tag-link-7" title="1 Posts">lvm2<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/makefile/" class="tag-link-3" title="1 Posts">makefile<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/mariadb/" class="tag-link-4" title="1 Posts">mariadb<small>(5)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/mathjax/" class="tag-link-4" title="1 Posts">mathjax<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/mbr/" class="tag-link-8" title="1 Posts">mbr<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/md5/" class="tag-link-8" title="1 Posts">md5<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/md5sum/" class="tag-link-5" title="1 Posts">md5sum<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/meteor/" class="tag-link-5" title="1 Posts">meteor<small>(7)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/mongodb/" class="tag-link-4" title="1 Posts">mongodb<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/mtr/" class="tag-link-8" title="1 Posts">mtr<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/mysql/" class="tag-link-6" title="1 Posts">mysql<small>(38)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/navicat64/" class="tag-link-2" title="1 Posts">navicat64<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/nessus/" class="tag-link-5" title="1 Posts">nessus<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/netcat/" class="tag-link-5" title="1 Posts">netcat<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/netsh/" class="tag-link-6" title="1 Posts">netsh<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/nexpose/" class="tag-link-4" title="1 Posts">nexpose<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/nginx/" class="tag-link-6" title="1 Posts">nginx<small>(26)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/nmap/" class="tag-link-7" title="1 Posts">nmap<small>(3)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/nodejs/" class="tag-link-5" title="1 Posts">nodejs<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/npm/" class="tag-link-8" title="1 Posts">npm<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/ntp/" class="tag-link-8" title="1 Posts">ntp<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/nvic/" class="tag-link-7" title="1 Posts">nvic<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/oauth2/" class="tag-link-5" title="1 Posts">oauth2<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/objdump/" class="tag-link-4" title="1 Posts">objdump<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/openssl/" class="tag-link-4" title="1 Posts">openssl<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/pandoc/" class="tag-link-5" title="1 Posts">pandoc<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/php/" class="tag-link-8" title="1 Posts">php<small>(3)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/postgresql/" class="tag-link-1" title="1 Posts">postgresql<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/powershell/" class="tag-link-1" title="1 Posts">powershell<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/prometheus/" class="tag-link-1" title="1 Posts">prometheus<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/proxy/" class="tag-link-6" title="1 Posts">proxy<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/python/" class="tag-link-5" title="1 Posts">python<small>(5)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/redis/" class="tag-link-6" title="1 Posts">redis<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/rename/" class="tag-link-5" title="1 Posts">rename<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/repo/" class="tag-link-7" title="1 Posts">repo<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/resin/" class="tag-link-6" title="1 Posts">resin<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/responsive/" class="tag-link-1" title="1 Posts">responsive<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/restful/" class="tag-link-4" title="1 Posts">restful<small>(4)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/rethinkdb/" class="tag-link-2" title="1 Posts">rethinkdb<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/retina/" class="tag-link-5" title="1 Posts">retina<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/root/" class="tag-link-7" title="1 Posts">root<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/route/" class="tag-link-6" title="1 Posts">route<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/rsync/" class="tag-link-6" title="1 Posts">rsync<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/rtsp/" class="tag-link-7" title="1 Posts">rtsp<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/ruby/" class="tag-link-7" title="1 Posts">ruby<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/samba/" class="tag-link-6" title="1 Posts">samba<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/sar/" class="tag-link-8" title="1 Posts">sar<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/scp/" class="tag-link-8" title="1 Posts">scp<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/scrapy/" class="tag-link-5" title="1 Posts">scrapy<small>(8)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/sed/" class="tag-link-8" title="1 Posts">sed<small>(3)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/selenium/" class="tag-link-3" title="1 Posts">selenium<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/sftp/" class="tag-link-7" title="1 Posts">sftp<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/shell/" class="tag-link-6" title="1 Posts">shell<small>(6)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/snap/" class="tag-link-7" title="1 Posts">snap<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/sort/" class="tag-link-7" title="1 Posts">sort<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/ssh/" class="tag-link-8" title="1 Posts">ssh<small>(3)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/ssl/" class="tag-link-8" title="1 Posts">ssl<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/sso/" class="tag-link-8" title="1 Posts">sso<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/ssrf/" class="tag-link-7" title="1 Posts">ssrf<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/stm32/" class="tag-link-6" title="1 Posts">stm32<small>(5)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/sublime/" class="tag-link-4" title="1 Posts">sublime<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/sudo/" class="tag-link-7" title="1 Posts">sudo<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/svg/" class="tag-link-8" title="1 Posts">svg<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/swagger/" class="tag-link-4" title="1 Posts">swagger<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/swarm/" class="tag-link-6" title="1 Posts">swarm<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/sysbench/" class="tag-link-3" title="1 Posts">sysbench<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/systemctl/" class="tag-link-2" title="1 Posts">systemctl<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/tc/" class="tag-link-9" title="1 Posts">tc<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/tcpdump/" class="tag-link-4" title="1 Posts">tcpdump<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/tim/" class="tag-link-8" title="1 Posts">tim<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/time/" class="tag-link-7" title="1 Posts">time<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/timezone/" class="tag-link-3" title="1 Posts">timezone<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/tmux/" class="tag-link-7" title="1 Posts">tmux<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/top/" class="tag-link-8" title="1 Posts">top<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/tr/" class="tag-link-9" title="1 Posts">tr<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/tshark/" class="tag-link-5" title="1 Posts">tshark<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/ubuntu/" class="tag-link-5" title="1 Posts">ubuntu<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/ulimit/" class="tag-link-5" title="1 Posts">ulimit<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/underscore/" class="tag-link-1" title="1 Posts">underscore<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/unpack/" class="tag-link-5" title="1 Posts">unpack<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/update-alternatives/" class="tag-link--8" title="1 Posts">update-alternatives<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/useradd/" class="tag-link-4" title="1 Posts">useradd<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/vim/" class="tag-link-8" title="1 Posts">vim<small>(9)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/visualstudiocode/" class="tag-link--5" title="1 Posts">visualstudiocode<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/vlc/" class="tag-link-8" title="1 Posts">vlc<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/webpack3/" class="tag-link-3" title="1 Posts">webpack3<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/wget/" class="tag-link-7" title="1 Posts">wget<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/windows10/" class="tag-link-2" title="1 Posts">windows10<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/windump/" class="tag-link-4" title="1 Posts">windump<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/wireshark/" class="tag-link-2" title="1 Posts">wireshark<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/xargs/" class="tag-link-6" title="1 Posts">xargs<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/xidel/" class="tag-link-6" title="1 Posts">xidel<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/xml/" class="tag-link-8" title="1 Posts">xml<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/xmllint/" class="tag-link-4" title="1 Posts">xmllint<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/xpath/" class="tag-link-6" title="1 Posts">xpath<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/yaml/" class="tag-link-7" title="1 Posts">yaml<small>(2)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/zabbix/" class="tag-link-5" title="1 Posts">zabbix<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/%E5%93%8D%E5%BA%94%E5%BC%8F/" class="tag-link-2" title="1 Posts">响应式<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" class="tag-link--4" title="1 Posts">自动化测试<small>(1)</small></a>
      
         <a rel="tag" href="http://blog.pytool.com/tags/%E8%B4%A6%E6%88%B7%E7%B3%BB%E7%BB%9F/" class="tag-link--1" title="1 Posts">账户系统<small>(1)</small></a>
      
  </div>
</div>

    

    
  </div>
</div>

        </div>
      </div>
    </div>
  </div>
</div>


<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-106129999-2', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>
<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?e2103759b6030b3c4ac84c63c542e493";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>

<script id="baidu_push">
  (function(){
    if (window.location.hostname === 'localhost') return;
    var bp = document.createElement('script'); bp.async = true;
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>

<footer id="footer">
  <section class="container" id="footer-bottom">
    <div class="container-inner">
      <a id="back-to-top" href="#"><i class="fa fa-angle-up"></i></a>
      <div class="pad group">
        <div class="grid one-half">
          <div id="copyright">
              <p>Copyright (c) 2017. All rights reserved. (版权所有) <a href='http://www.miitbeian.gov.cn/'>鲁ICP备17074587号-1</a></p>
              
          </div>
          
        </div>
        
        <div class="grid one-half last">
          <ul class="social-links">
    <li>
    <a class="social-tooltip" title="On WeiBo"
        href="http://weibo.com/rinetd" target="_blank">
        <i class="fa fa-weibo"></i>
    </a>
    </li>
    <li>
    <a class="social-tooltip" title="On Twitter" rel="nofollow"
        href="https://twitter.com/rinetd" target="_blank">
        <i class="fa fa-twitter"></i>
    </a>
    </li>
    <li>
    <a class="social-tooltip" title="On GitHub"
        href="https://github.com/rinetd" target="_blank">
        <i class="fa fa-github"></i>
    </a>
    </li>
</ul>

        </div>
      </div>

    </div>
    
  </section>
  
</footer>



<script src="http://blog.pytool.com/public/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
<script type="text/javascript" src="http://blog.pytool.com/wp-content/themes/hueman/js/jquery.jplayer.min.js"></script>
<script type="text/javascript" src="http://blog.pytool.com/wp-content/themes/hueman/js/scripts.js"></script>
<script type="text/javascript" src="http://blog.pytool.com/assets/picturefill/picturefill.min.js"></script>
<script type="text/javascript" src="http://blog.pytool.com/assets/js/jquery.matchHeight-min.js"></script>
<script type="text/javascript" async defer src="http://blog.pytool.com/assets/js/myblog.js"></script>

</body>
</html>

